02/23/2023 12:06:49:INFO: start.
02/23/2023 12:06:49:INFO: --------hyper-arguments for this training.--------
02/23/2023 12:06:49:INFO: Namespace(answer_strategy='inter_logits_core_token', batch_size=2, dataset='rest14', eval_pre_epochs=1, few_shot=20, learning_rate=1e-05, log_file=None, model_type='WT2ABSA_Mean', patience=5, pre_trained_model='pretrainedmodels/bert-base-cased', save_best_model=False, seed=985, total_epochs=20)
02/23/2023 12:06:49:INFO: ----------dataset files------------
02/23/2023 12:06:49:INFO: {'train': '../WordTrans2ABSA/dataset/rest14/train.json', 'dev': '../WordTrans2ABSA/dataset/rest14/dev.json', 'test': '../WordTrans2ABSA/dataset/rest14/test.json'}
02/23/2023 12:06:51:WARNING: Using custom data configuration default-60cac04a9729a80a
02/23/2023 12:06:51:WARNING: Reusing dataset json (C:\Users\Super-IdoI\.cache\huggingface\datasets\json\default-60cac04a9729a80a\0.0.0\45636811569ec4a6630521c18235dfbbab83b7ab572e3393c5ba68ccabe98264)
02/23/2023 12:06:51:INFO: -----------------------------------
02/23/2023 12:06:51:INFO: {'I-POS': ['good', 'clever', 'excellent', 'effectual', 'beautiful', 'nice', 'useful', 'well', 'fantastic'], 'I-NEU': ['Michael', 'John', 'David', 'Thomas', 'Martin', 'Paul'], 'I-NEG': ['bad', 'terrible', 'awful', 'badly', 'terrible', 'poor', 'unfortunate', 'harmful', 'dirty', 'sorry']}
02/23/2023 12:06:51:INFO: -----------------------------------
02/23/2023 12:06:51:INFO: {'O': 0, 'I-POS': 1, 'I-NEU': 2, 'I-NEG': 3}
02/23/2023 12:06:51:INFO: {0: 'O', 1: 'I-POS', 2: 'I-NEU', 3: 'I-NEG'}
02/23/2023 12:06:53:INFO: -----------------------------------
02/23/2023 12:06:53:INFO: {'I-POS': 28996, 'I-NEU': 28997, 'I-NEG': 28998}
02/23/2023 12:06:53:INFO: {28996: 'I-POS', 28997: 'I-NEU', 28998: 'I-NEG'}
02/23/2023 12:06:53:INFO: start preprocess dataset.
02/23/2023 12:06:53:WARNING: Loading cached processed dataset at C:\Users\Super-IdoI\.cache\huggingface\datasets\json\default-60cac04a9729a80a\0.0.0\45636811569ec4a6630521c18235dfbbab83b7ab572e3393c5ba68ccabe98264\cache-a4906c9542925d39.arrow
02/23/2023 12:06:53:WARNING: Loading cached processed dataset at C:\Users\Super-IdoI\.cache\huggingface\datasets\json\default-60cac04a9729a80a\0.0.0\45636811569ec4a6630521c18235dfbbab83b7ab572e3393c5ba68ccabe98264\cache-cc122a5979c9fd57.arrow
02/23/2023 12:06:53:INFO: dataset preprocess finished.
02/23/2023 12:06:53:WARNING: Loading cached processed dataset at C:\Users\Super-IdoI\.cache\huggingface\datasets\json\default-60cac04a9729a80a\0.0.0\45636811569ec4a6630521c18235dfbbab83b7ab572e3393c5ba68ccabe98264\cache-958b3a3e4bbc7295.arrow
02/23/2023 12:06:53:INFO: Train: 60, Dev: 179, Test: 599.
02/23/2023 12:06:53:INFO: dataloader prepare finished.
02/23/2023 12:06:53:INFO: ***** Start Training *****
02/23/2023 12:06:53:INFO: Total Epochs: 20
02/23/2023 12:06:53:INFO: validate on per-1 epochs.
02/23/2023 12:06:53:INFO: Training Samples Count: 60.
02/23/2023 12:06:53:INFO: Batch Size: 2, 每轮 30 Batch.
02/23/2023 12:06:53:INFO: Learning Rate: 1e-05
02/23/2023 12:06:53:INFO: --------------Epoch. 1.---------------
02/23/2023 12:06:56:INFO: [Epoch. 1.]: 100%|| 30/30 [00:02<00:00, 12.66it/s, avg_loss=1.37]
02/23/2023 12:06:56:INFO: Epoch 1, average loss: 1.3698430399099986
02/23/2023 12:06:56:INFO: --------------Evaluate on Epoch. 1.---------------
02/23/2023 12:06:56:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 12:06:57:INFO: **********Results Comparison**********
02/23/2023 12:06:57:INFO: 真实标签: 
 [3, 1, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 3, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 2, 3, 1, 3, 1, 2, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 1, 3, 3, 1, 2, 3, 1, 1, 1, 2, 1, 1, 1, 2, 3, 1, 1, 2, 1, 1, 3, 1, 1, 1, 1, 1, 2, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 2, 1, 3, 3, 1, 3, 2, 2, 1, 1, 3, 1, 2, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 3, 1, 1, 1, 2, 1, 2, 2, 3, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1]
02/23/2023 12:06:57:INFO: 预测标签: 
 [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 3, 1, 1, 1, 1, 1, 1, 3, 1, 1, 2, 3, 1, 3, 2, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 2, 1, 1, 3, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 3, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 3, 3, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 3, 1, 2, 2, 1, 3, 1, 1, 2, 1, 1, 1, 1]
02/23/2023 12:06:57:INFO: ---------Evaluated Metrics----------
02/23/2023 12:06:57:INFO: Accuracy: 0.6312849162011173.
02/23/2023 12:06:57:INFO: Macro Precision: 0.47902979373567617.
02/23/2023 12:06:57:INFO: Macro Recall: 0.43674180327868856.
02/23/2023 12:06:57:INFO: Macro F1 score: 0.44943926114409577.
02/23/2023 12:06:57:INFO: ---------confusion_matrix----------
02/23/2023 12:06:57:INFO: 
[[99 14  9]
 [24  7  1]
 [17  1  7]]
02/23/2023 12:06:57:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 12:06:57:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 12:06:57:INFO: --------------Epoch. 2.---------------
02/23/2023 12:06:59:INFO: [Epoch. 2.]: 100%|| 30/30 [00:02<00:00, 14.06it/s, avg_loss=0.757]
02/23/2023 12:06:59:INFO: Epoch 2, average loss: 0.7573802322149277
02/23/2023 12:06:59:INFO: --------------Evaluate on Epoch. 2.---------------
02/23/2023 12:06:59:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 12:07:00:INFO: **********Results Comparison**********
02/23/2023 12:07:00:INFO: 真实标签: 
 [3, 1, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 3, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 2, 3, 1, 3, 1, 2, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 1, 3, 3, 1, 2, 3, 1, 1, 1, 2, 1, 1, 1, 2, 3, 1, 1, 2, 1, 1, 3, 1, 1, 1, 1, 1, 2, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 2, 1, 3, 3, 1, 3, 2, 2, 1, 1, 3, 1, 2, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 3, 1, 1, 1, 2, 1, 2, 2, 3, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1]
02/23/2023 12:07:00:INFO: 预测标签: 
 [2, 1, 1, 1, 1, 1, 1, 1, 3, 1, 3, 1, 3, 2, 2, 3, 2, 2, 1, 2, 3, 2, 2, 2, 2, 1, 2, 1, 1, 2, 2, 1, 2, 2, 1, 3, 1, 2, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 3, 2, 2, 2, 2, 2, 3, 3, 1, 2, 1, 1, 3, 3, 1, 2, 2, 3, 1, 3, 2, 2, 3, 3, 1, 2, 2, 2, 3, 3, 1, 1, 1, 2, 1, 1, 2, 2, 3, 1, 1, 3, 3, 1, 2, 3, 3, 2, 2, 3, 2, 3, 3, 3, 2, 1, 2, 1, 1, 2, 3, 1, 3, 2, 2, 1, 2, 2, 1, 3, 1, 3, 2, 2, 1, 1, 3, 2, 1, 1, 2, 2, 3, 3, 2, 1, 1, 3, 1, 2, 2, 1, 1, 2, 2, 1, 3, 3, 3, 3, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 3, 1, 2, 2, 1, 2, 1, 3, 2, 1, 3, 1, 2]
02/23/2023 12:07:00:INFO: ---------Evaluated Metrics----------
02/23/2023 12:07:00:INFO: Accuracy: 0.5027932960893855.
02/23/2023 12:07:00:INFO: Macro Precision: 0.47050309849967387.
02/23/2023 12:07:00:INFO: Macro Recall: 0.5125000000000001.
02/23/2023 12:07:00:INFO: Macro F1 score: 0.45502296211251436.
02/23/2023 12:07:00:INFO: ---------confusion_matrix----------
02/23/2023 12:07:00:INFO: 
[[61 42 19]
 [10 14  8]
 [ 2  8 15]]
02/23/2023 12:07:00:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 12:07:00:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 12:07:00:INFO: --------------Epoch. 3.---------------
02/23/2023 12:07:02:INFO: [Epoch. 3.]: 100%|| 30/30 [00:02<00:00, 14.38it/s, avg_loss=0.467]
02/23/2023 12:07:02:INFO: Epoch 3, average loss: 0.46674691985050837
02/23/2023 12:07:02:INFO: --------------Evaluate on Epoch. 3.---------------
02/23/2023 12:07:02:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 12:07:03:INFO: **********Results Comparison**********
02/23/2023 12:07:03:INFO: 真实标签: 
 [3, 1, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 3, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 2, 3, 1, 3, 1, 2, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 1, 3, 3, 1, 2, 3, 1, 1, 1, 2, 1, 1, 1, 2, 3, 1, 1, 2, 1, 1, 3, 1, 1, 1, 1, 1, 2, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 2, 1, 3, 3, 1, 3, 2, 2, 1, 1, 3, 1, 2, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 3, 1, 1, 1, 2, 1, 2, 2, 3, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1]
02/23/2023 12:07:03:INFO: 预测标签: 
 [2, 1, 1, 1, 1, 3, 3, 2, 2, 1, 3, 2, 3, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 1, 2, 2, 2, 1, 2, 2, 1, 3, 1, 2, 1, 1, 2, 2, 2, 1, 2, 1, 1, 1, 3, 2, 2, 2, 2, 2, 3, 2, 1, 2, 2, 2, 3, 3, 2, 2, 2, 3, 1, 3, 2, 2, 3, 1, 1, 2, 2, 2, 3, 3, 1, 1, 2, 2, 2, 1, 2, 2, 2, 2, 1, 3, 2, 1, 2, 3, 3, 2, 2, 2, 2, 3, 3, 3, 2, 1, 2, 1, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 1, 3, 2, 3, 2, 2, 1, 1, 2, 2, 3, 2, 2, 2, 1, 3, 2, 1, 1, 3, 2, 2, 2, 1, 1, 2, 2, 1, 3, 3, 2, 3, 1, 1, 2, 2, 1, 1, 1, 1, 2, 2, 1, 1, 3, 2, 1, 1, 1, 1, 3, 2, 2, 2, 1, 2, 2, 2, 2, 1, 3, 1, 2]
02/23/2023 12:07:03:INFO: ---------Evaluated Metrics----------
02/23/2023 12:07:03:INFO: Accuracy: 0.3743016759776536.
02/23/2023 12:07:03:INFO: Macro Precision: 0.4322544328736279.
02/23/2023 12:07:03:INFO: Macro Recall: 0.433224043715847.
02/23/2023 12:07:03:INFO: Macro F1 score: 0.3722095531361351.
02/23/2023 12:07:03:INFO: ---------confusion_matrix----------
02/23/2023 12:07:03:INFO: 
[[39 68 15]
 [10 16  6]
 [ 2 11 12]]
02/23/2023 12:07:03:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 12:07:03:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 12:07:03:INFO: --------------Epoch. 4.---------------
02/23/2023 12:07:06:INFO: [Epoch. 4.]: 100%|| 30/30 [00:02<00:00, 14.45it/s, avg_loss=0.301]
02/23/2023 12:07:06:INFO: Epoch 4, average loss: 0.3013100172082583
02/23/2023 12:07:06:INFO: --------------Evaluate on Epoch. 4.---------------
02/23/2023 12:07:06:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 12:07:07:INFO: **********Results Comparison**********
02/23/2023 12:07:07:INFO: 真实标签: 
 [3, 1, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 3, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 2, 3, 1, 3, 1, 2, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 1, 3, 3, 1, 2, 3, 1, 1, 1, 2, 1, 1, 1, 2, 3, 1, 1, 2, 1, 1, 3, 1, 1, 1, 1, 1, 2, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 2, 1, 3, 3, 1, 3, 2, 2, 1, 1, 3, 1, 2, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 3, 1, 1, 1, 2, 1, 2, 2, 3, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1]
02/23/2023 12:07:07:INFO: 预测标签: 
 [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 3, 1, 1, 3, 1, 2, 1, 2, 1, 2, 2, 2, 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 1, 1, 2, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 3, 2, 2, 2, 2, 2, 3, 1, 1, 2, 1, 2, 1, 3, 1, 1, 2, 3, 1, 3, 2, 2, 3, 1, 1, 2, 2, 2, 3, 3, 1, 1, 1, 2, 1, 1, 2, 2, 2, 1, 1, 3, 2, 1, 2, 3, 3, 1, 2, 1, 2, 3, 3, 3, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 3, 1, 2, 2, 1, 3, 1, 1, 2, 2, 1, 1, 2, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 3, 1, 2, 2, 1, 1, 2, 1, 1, 3, 3, 1, 3, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 3, 1, 2, 2, 1, 2, 1, 1, 2, 1, 3, 1, 2]
02/23/2023 12:07:07:INFO: ---------Evaluated Metrics----------
02/23/2023 12:07:07:INFO: Accuracy: 0.547486033519553.
02/23/2023 12:07:07:INFO: Macro Precision: 0.4556061089825458.
02/23/2023 12:07:07:INFO: Macro Recall: 0.4736680327868852.
02/23/2023 12:07:07:INFO: Macro F1 score: 0.45358978208704404.
02/23/2023 12:07:07:INFO: ---------confusion_matrix----------
02/23/2023 12:07:07:INFO: 
[[75 33 14]
 [14 13  5]
 [ 7  8 10]]
02/23/2023 12:07:07:INFO: 模型效果验证详情: {'位置第一个显示标签': 2, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 12:07:07:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 12:07:07:INFO: --------------Epoch. 5.---------------
02/23/2023 12:07:09:INFO: [Epoch. 5.]: 100%|| 30/30 [00:02<00:00, 14.44it/s, avg_loss=0.213]
02/23/2023 12:07:09:INFO: Epoch 5, average loss: 0.2126851459344228
02/23/2023 12:07:09:INFO: --------------Evaluate on Epoch. 5.---------------
02/23/2023 12:07:09:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 12:07:10:INFO: **********Results Comparison**********
02/23/2023 12:07:10:INFO: 真实标签: 
 [3, 1, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 3, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 2, 3, 1, 3, 1, 2, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 1, 3, 3, 1, 2, 3, 1, 1, 1, 2, 1, 1, 1, 2, 3, 1, 1, 2, 1, 1, 3, 1, 1, 1, 1, 1, 2, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 2, 1, 3, 3, 1, 3, 2, 2, 1, 1, 3, 1, 2, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 3, 1, 1, 1, 2, 1, 2, 2, 3, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1]
02/23/2023 12:07:10:INFO: 预测标签: 
 [2, 1, 1, 1, 1, 3, 1, 1, 2, 1, 3, 1, 3, 1, 1, 3, 2, 2, 3, 2, 1, 2, 2, 2, 2, 1, 2, 1, 1, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 3, 2, 2, 2, 2, 2, 3, 1, 1, 2, 1, 2, 1, 3, 1, 2, 2, 3, 1, 3, 2, 2, 3, 1, 1, 2, 2, 2, 3, 3, 1, 1, 1, 2, 3, 1, 2, 2, 2, 1, 1, 3, 2, 1, 2, 3, 3, 2, 2, 1, 2, 3, 3, 3, 1, 1, 2, 1, 1, 2, 2, 2, 3, 2, 2, 2, 2, 2, 1, 3, 2, 3, 2, 2, 1, 1, 2, 2, 3, 1, 2, 1, 1, 3, 2, 1, 1, 3, 1, 2, 2, 1, 1, 2, 1, 1, 3, 3, 1, 3, 1, 1, 2, 1, 1, 1, 1, 1, 2, 2, 1, 1, 3, 2, 1, 1, 1, 1, 3, 1, 2, 2, 1, 2, 2, 3, 2, 1, 3, 1, 2]
02/23/2023 12:07:10:INFO: ---------Evaluated Metrics----------
02/23/2023 12:07:10:INFO: Accuracy: 0.48044692737430167.
02/23/2023 12:07:10:INFO: Macro Precision: 0.4453216374269006.
02/23/2023 12:07:10:INFO: Macro Recall: 0.45916666666666667.
02/23/2023 12:07:10:INFO: Macro F1 score: 0.42332725497025697.
02/23/2023 12:07:10:INFO: ---------confusion_matrix----------
02/23/2023 12:07:10:INFO: 
[[61 46 15]
 [11 14  7]
 [ 4 10 11]]
02/23/2023 12:07:10:INFO: 模型效果验证详情: {'位置第一个显示标签': 25, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 12:07:10:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 12:07:10:INFO: --------------Epoch. 6.---------------
02/23/2023 12:07:12:INFO: [Epoch. 6.]: 100%|| 30/30 [00:02<00:00, 14.24it/s, avg_loss=0.153]
02/23/2023 12:07:12:INFO: Epoch 6, average loss: 0.15277380359669526
02/23/2023 12:07:12:INFO: --------------Evaluate on Epoch. 6.---------------
02/23/2023 12:07:12:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 12:07:13:INFO: **********Results Comparison**********
02/23/2023 12:07:13:INFO: 真实标签: 
 [3, 1, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 3, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 2, 3, 1, 3, 1, 2, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 1, 3, 3, 1, 2, 3, 1, 1, 1, 2, 1, 1, 1, 2, 3, 1, 1, 2, 1, 1, 3, 1, 1, 1, 1, 1, 2, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 2, 1, 3, 3, 1, 3, 2, 2, 1, 1, 3, 1, 2, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 3, 1, 1, 1, 2, 1, 2, 2, 3, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1]
02/23/2023 12:07:13:INFO: 预测标签: 
 [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 3, 1, 1, 2, 2, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 1, 1, 2, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 1, 1, 2, 1, 2, 1, 3, 1, 1, 2, 3, 1, 3, 2, 2, 3, 1, 1, 2, 2, 2, 3, 1, 1, 1, 1, 2, 1, 1, 2, 2, 2, 1, 1, 3, 2, 1, 2, 1, 3, 1, 2, 1, 2, 3, 3, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 2, 2, 1, 2, 2, 1, 3, 2, 1, 2, 2, 1, 1, 2, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 2, 2, 1, 1, 2, 1, 1, 3, 3, 1, 3, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 3, 1, 2, 2, 1, 2, 1, 1, 2, 1, 3, 1, 2]
02/23/2023 12:07:13:INFO: ---------Evaluated Metrics----------
02/23/2023 12:07:13:INFO: Accuracy: 0.5754189944134078.
02/23/2023 12:07:13:INFO: Macro Precision: 0.47005053085788906.
02/23/2023 12:07:13:INFO: Macro Recall: 0.46321038251366126.
02/23/2023 12:07:13:INFO: Macro F1 score: 0.4538924828812469.
02/23/2023 12:07:13:INFO: ---------confusion_matrix----------
02/23/2023 12:07:13:INFO: 
[[82 33  7]
 [13 14  5]
 [ 8 10  7]]
02/23/2023 12:07:13:INFO: 模型效果验证详情: {'位置第一个显示标签': 29, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 12:07:13:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 12:07:13:INFO: --------------Epoch. 7.---------------
02/23/2023 12:07:15:INFO: [Epoch. 7.]: 100%|| 30/30 [00:02<00:00, 14.39it/s, avg_loss=0.115]
02/23/2023 12:07:15:INFO: Epoch 7, average loss: 0.11461985173324744
02/23/2023 12:07:15:INFO: --------------Evaluate on Epoch. 7.---------------
02/23/2023 12:07:15:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 12:07:16:INFO: **********Results Comparison**********
02/23/2023 12:07:16:INFO: 真实标签: 
 [3, 1, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 3, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 2, 3, 1, 3, 1, 2, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 1, 3, 3, 1, 2, 3, 1, 1, 1, 2, 1, 1, 1, 2, 3, 1, 1, 2, 1, 1, 3, 1, 1, 1, 1, 1, 2, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 2, 1, 3, 3, 1, 3, 2, 2, 1, 1, 3, 1, 2, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 3, 1, 1, 1, 2, 1, 2, 2, 3, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1]
02/23/2023 12:07:16:INFO: 预测标签: 
 [1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 3, 1, 3, 1, 1, 3, 2, 2, 3, 2, 1, 2, 2, 1, 2, 1, 2, 3, 1, 3, 1, 1, 2, 2, 1, 3, 1, 2, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 3, 2, 2, 2, 2, 2, 3, 1, 3, 2, 1, 2, 1, 3, 1, 1, 2, 3, 1, 3, 2, 2, 3, 1, 1, 2, 2, 2, 3, 3, 1, 1, 1, 2, 3, 1, 2, 2, 2, 1, 1, 3, 2, 1, 2, 3, 3, 1, 2, 1, 2, 3, 3, 3, 1, 1, 2, 1, 1, 2, 3, 1, 3, 2, 3, 2, 2, 2, 3, 3, 2, 3, 2, 2, 1, 1, 2, 2, 3, 1, 2, 1, 1, 3, 2, 1, 1, 3, 1, 3, 2, 1, 1, 2, 1, 1, 3, 3, 1, 3, 1, 1, 2, 1, 1, 3, 1, 1, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 3, 1, 2, 2, 1, 2, 1, 3, 2, 1, 3, 1, 2]
02/23/2023 12:07:16:INFO: ---------Evaluated Metrics----------
02/23/2023 12:07:16:INFO: Accuracy: 0.5586592178770949.
02/23/2023 12:07:16:INFO: Macro Precision: 0.49694533622182196.
02/23/2023 12:07:16:INFO: Macro Recall: 0.5504234972677596.
02/23/2023 12:07:16:INFO: Macro F1 score: 0.4940274960558937.
02/23/2023 12:07:16:INFO: ---------confusion_matrix----------
02/23/2023 12:07:16:INFO: 
[[70 34 18]
 [ 9 14  9]
 [ 2  7 16]]
02/23/2023 12:07:16:INFO: 模型效果验证详情: {'位置第一个显示标签': 50, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 12:07:16:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 12:07:16:INFO: Based on [2.th Epoch] best_accuracy: 0.6312849162011173.
02/23/2023 12:07:16:INFO: latest 5 epochs not seen performance increased, early stop.
02/23/2023 12:07:16:INFO: ********** Best Results on Dev Dataset **********
02/23/2023 12:07:16:INFO: Best Accuracy: 0.6312849162011173.
02/23/2023 12:07:16:INFO: Best Macro Precision: 0.49694533622182196.
02/23/2023 12:07:16:INFO: Best Macro Recall: 0.5504234972677596.
02/23/2023 12:07:16:INFO: Best Macro F1 score: 0.4940274960558937.
02/23/2023 12:07:16:INFO: ***** Training Over *****
02/23/2023 12:07:16:INFO: --------------Testing ...---------------
02/23/2023 12:07:16:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 12:07:20:INFO: **********Results Comparison**********
02/23/2023 12:07:20:INFO: 真实标签: 
 [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 3, 3, 3, 1, 1, 2, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 3, 1, 1, 1, 1, 1, 1, 2, 1, 3, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 3, 1, 3, 3, 1, 1, 1, 1, 1, 3, 1, 1, 1, 2, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 3, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 3, 3, 3, 1, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 2, 1, 3, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 2, 1, 3, 2, 2, 1, 1, 1, 2, 1, 3, 3, 1, 3, 3, 3, 1, 1, 2, 3, 1, 1, 3, 1, 3, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 2, 1, 1, 1, 2, 1, 3, 1, 3, 2, 1, 3, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1, 2, 3, 3, 3, 1, 1, 1, 1, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 2, 1, 3, 1, 2, 1, 1, 1, 1, 2, 3, 1, 1, 2, 3, 2, 2, 2, 1, 1, 1, 2, 1, 1, 1, 1, 2, 3, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 2, 2, 1, 2, 1, 2, 1, 1, 1, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 3, 1, 2, 2, 1, 1, 1, 2, 2, 1, 1, 1, 3, 1, 2, 1, 2, 1, 1, 2, 1, 1, 1, 2, 2, 1, 1, 1, 2, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1, 1, 2, 3, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 3, 2, 1, 3, 1, 1, 1, 1, 1, 3, 2, 1, 1, 2, 1, 3, 1, 2, 1, 1, 1, 1, 2, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 2, 3, 2, 2, 1, 2, 3, 2, 1, 1, 2, 3, 1, 1, 2, 2, 1, 1, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 3, 1, 1, 1, 1, 2, 2, 1, 3, 1, 3, 3, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 3, 1, 2, 1, 1, 2, 1, 1, 1, 2, 2, 2, 2, 1, 2, 2, 2, 1, 2, 3, 1, 3, 3, 1]
02/23/2023 12:07:20:INFO: 预测标签: 
 [1, 3, 2, 2, 1, 2, 1, 1, 1, 1, 2, 3, 2, 2, 3, 3, 2, 3, 3, 2, 3, 2, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 3, 2, 3, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 1, 1, 1, 1, 1, 3, 2, 1, 2, 3, 1, 3, 2, 1, 1, 1, 1, 1, 3, 3, 3, 1, 2, 2, 3, 3, 1, 1, 2, 2, 1, 1, 1, 3, 1, 1, 1, 1, 2, 3, 1, 1, 3, 2, 3, 1, 3, 1, 1, 3, 3, 2, 2, 3, 2, 1, 1, 3, 1, 1, 2, 2, 1, 1, 1, 2, 3, 3, 1, 2, 1, 3, 2, 1, 1, 3, 1, 1, 1, 2, 1, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 2, 1, 3, 3, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 3, 2, 2, 2, 1, 1, 1, 3, 1, 1, 1, 1, 2, 1, 1, 2, 1, 2, 3, 1, 3, 1, 3, 3, 2, 2, 1, 1, 2, 1, 3, 2, 2, 3, 3, 3, 2, 1, 3, 1, 1, 1, 3, 1, 2, 3, 1, 3, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 3, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 2, 1, 1, 2, 2, 1, 2, 3, 2, 2, 3, 2, 2, 1, 1, 3, 2, 1, 3, 1, 3, 2, 3, 1, 3, 1, 1, 1, 3, 1, 2, 2, 2, 1, 2, 3, 2, 2, 2, 2, 3, 3, 1, 1, 3, 1, 1, 1, 1, 2, 3, 3, 1, 1, 3, 3, 1, 2, 1, 1, 3, 1, 3, 1, 2, 1, 1, 1, 1, 3, 1, 1, 3, 3, 2, 3, 3, 3, 3, 2, 2, 2, 1, 1, 2, 2, 1, 1, 1, 2, 3, 2, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1, 1, 1, 3, 3, 1, 1, 3, 2, 1, 2, 2, 2, 1, 3, 1, 1, 1, 2, 3, 2, 1, 1, 1, 1, 1, 1, 2, 3, 3, 1, 1, 3, 2, 1, 1, 1, 1, 1, 1, 1, 3, 2, 2, 3, 2, 2, 3, 1, 3, 1, 3, 1, 1, 1, 2, 1, 3, 2, 1, 2, 3, 3, 1, 3, 1, 2, 2, 3, 2, 2, 1, 1, 2, 3, 1, 1, 3, 2, 1, 2, 1, 2, 1, 3, 3, 2, 1, 2, 2, 2, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 3, 3, 3, 2, 2, 1, 1, 2, 3, 2, 2, 1, 1, 1, 1, 3, 3, 2, 2, 3, 1, 1, 2, 2, 1, 2, 1, 3, 1, 1, 2, 1, 2, 3, 1, 1, 1, 2, 2, 2, 1, 1, 1, 1, 2, 1, 1, 2, 2, 1, 1, 1, 1, 3, 2, 3, 2, 1, 3, 1, 3, 1, 1, 1, 1, 3, 1, 1, 2, 2, 3, 2, 2, 1, 1, 3, 1, 1, 1, 3, 3, 2, 1, 3, 3, 2, 3, 1, 2, 2, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 2, 1, 2, 2, 1, 2, 1, 1, 2, 1, 3, 1, 1, 1, 1, 1, 1, 3, 3, 1, 3, 3, 2, 2, 1, 1, 1, 3, 2, 1, 3, 2, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 3, 2, 1, 2, 2, 1, 2, 2, 1, 1]
02/23/2023 12:07:20:INFO: ---------Evaluated Metrics----------
02/23/2023 12:07:20:INFO: Accuracy: 0.6060100166944908.
02/23/2023 12:07:20:INFO: Macro Precision: 0.5290006574621958.
02/23/2023 12:07:20:INFO: Macro Recall: 0.5764965250458957.
02/23/2023 12:07:20:INFO: Macro F1 score: 0.5325482494824834.
02/23/2023 12:07:20:INFO: ---------confusion_matrix----------
02/23/2023 12:07:20:INFO: 
[[259 105  46]
 [ 27  43  23]
 [ 14  21  61]]
02/23/2023 12:07:20:INFO: 模型效果验证详情: {'位置第一个显示标签': 187, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 12:07:20:INFO: ----------------------Testing finished.------------------------
02/23/2023 12:07:20:INFO: bengio.
