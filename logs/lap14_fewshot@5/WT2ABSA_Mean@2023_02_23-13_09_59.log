02/23/2023 13:09:59:INFO: start.
02/23/2023 13:09:59:INFO: --------hyper-arguments for this training.--------
02/23/2023 13:09:59:INFO: Namespace(answer_strategy='inter_logits_core_token', batch_size=2, dataset='lap14', eval_pre_epochs=1, few_shot=5, learning_rate=1e-05, log_file=None, model_type='WT2ABSA_Mean', patience=5, pre_trained_model='pretrainedmodels/bert-base-cased', save_best_model=False, seed=985, total_epochs=20)
02/23/2023 13:09:59:INFO: ----------dataset files------------
02/23/2023 13:09:59:INFO: {'train': '../WordTrans2ABSA/dataset/lap14/train.json', 'dev': '../WordTrans2ABSA/dataset/lap14/dev.json', 'test': '../WordTrans2ABSA/dataset/lap14/test.json'}
02/23/2023 13:10:02:WARNING: Using custom data configuration default-36681205633e2245
02/23/2023 13:10:02:WARNING: Reusing dataset json (C:\Users\Super-IdoI\.cache\huggingface\datasets\json\default-36681205633e2245\0.0.0\45636811569ec4a6630521c18235dfbbab83b7ab572e3393c5ba68ccabe98264)
02/23/2023 13:10:02:INFO: -----------------------------------
02/23/2023 13:10:02:INFO: {'I-POS': ['good', 'clever', 'excellent', 'effectual', 'beautiful', 'nice', 'useful', 'well', 'fantastic'], 'I-NEU': ['Michael', 'John', 'David', 'Thomas', 'Martin', 'Paul'], 'I-NEG': ['bad', 'terrible', 'awful', 'badly', 'terrible', 'poor', 'unfortunate', 'harmful', 'dirty', 'sorry']}
02/23/2023 13:10:02:INFO: -----------------------------------
02/23/2023 13:10:02:INFO: {'O': 0, 'I-POS': 1, 'I-NEU': 2, 'I-NEG': 3}
02/23/2023 13:10:02:INFO: {0: 'O', 1: 'I-POS', 2: 'I-NEU', 3: 'I-NEG'}
02/23/2023 13:10:04:INFO: -----------------------------------
02/23/2023 13:10:04:INFO: {'I-POS': 28996, 'I-NEU': 28997, 'I-NEG': 28998}
02/23/2023 13:10:04:INFO: {28996: 'I-POS', 28997: 'I-NEU', 28998: 'I-NEG'}
02/23/2023 13:10:04:INFO: start preprocess dataset.
02/23/2023 13:10:04:WARNING: Loading cached processed dataset at C:\Users\Super-IdoI\.cache\huggingface\datasets\json\default-36681205633e2245\0.0.0\45636811569ec4a6630521c18235dfbbab83b7ab572e3393c5ba68ccabe98264\cache-f28bfe1b8bff3113.arrow
02/23/2023 13:10:04:WARNING: Loading cached processed dataset at C:\Users\Super-IdoI\.cache\huggingface\datasets\json\default-36681205633e2245\0.0.0\45636811569ec4a6630521c18235dfbbab83b7ab572e3393c5ba68ccabe98264\cache-77a4736853adbfc8.arrow
02/23/2023 13:10:04:INFO: dataset preprocess finished.
02/23/2023 13:10:04:WARNING: Loading cached processed dataset at C:\Users\Super-IdoI\.cache\huggingface\datasets\json\default-36681205633e2245\0.0.0\45636811569ec4a6630521c18235dfbbab83b7ab572e3393c5ba68ccabe98264\cache-2c94c1eeb3394478.arrow
02/23/2023 13:10:04:INFO: Train: 15, Dev: 150, Test: 409.
02/23/2023 13:10:04:INFO: dataloader prepare finished.
02/23/2023 13:10:04:INFO: ***** Start Training *****
02/23/2023 13:10:04:INFO: Total Epochs: 20
02/23/2023 13:10:04:INFO: validate on per-1 epochs.
02/23/2023 13:10:04:INFO: Training Samples Count: 15.
02/23/2023 13:10:04:INFO: Batch Size: 2, 每轮 8 Batch.
02/23/2023 13:10:04:INFO: Learning Rate: 1e-05
02/23/2023 13:10:04:INFO: --------------Epoch. 1.---------------
02/23/2023 13:10:05:INFO: [Epoch. 1.]: 100%|| 8/8 [00:00<00:00, 11.95it/s, avg_loss=1.96]
02/23/2023 13:10:05:INFO: Epoch 1, average loss: 1.9584804102778435
02/23/2023 13:10:05:INFO: --------------Evaluate on Epoch. 1.---------------
02/23/2023 13:10:05:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:10:06:INFO: **********Results Comparison**********
02/23/2023 13:10:06:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:10:06:INFO: 预测标签: 
 [1, 1, 3, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 3, 1, 2, 2, 2, 1, 3, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 2, 3, 1, 1, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 2, 1, 3, 2, 1, 1, 1, 1, 1, 1, 3, 3, 2, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 3, 1, 2, 2, 1, 3, 1, 2, 1, 1, 1, 3, 2, 1, 1, 1, 3, 1, 1, 3, 1, 2, 2, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 3, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 2, 3]
02/23/2023 13:10:06:INFO: ---------Evaluated Metrics----------
02/23/2023 13:10:06:INFO: Accuracy: 0.44666666666666666.
02/23/2023 13:10:06:INFO: Macro Precision: 0.4127844764589206.
02/23/2023 13:10:06:INFO: Macro Recall: 0.38207239663750214.
02/23/2023 13:10:06:INFO: Macro F1 score: 0.34844802785979256.
02/23/2023 13:10:06:INFO: ---------confusion_matrix----------
02/23/2023 13:10:06:INFO: 
[[53 12  2]
 [15  5  5]
 [35 14  9]]
02/23/2023 13:10:06:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:10:06:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:10:06:INFO: --------------Epoch. 2.---------------
02/23/2023 13:10:06:INFO: [Epoch. 2.]: 100%|| 8/8 [00:00<00:00, 15.41it/s, avg_loss=1.3]
02/23/2023 13:10:06:INFO: Epoch 2, average loss: 1.2964040897786617
02/23/2023 13:10:06:INFO: --------------Evaluate on Epoch. 2.---------------
02/23/2023 13:10:06:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:10:07:INFO: **********Results Comparison**********
02/23/2023 13:10:07:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:10:07:INFO: 预测标签: 
 [1, 1, 3, 3, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 3, 1, 3, 2, 2, 3, 3, 1, 1, 2, 3, 1, 1, 1, 3, 2, 1, 1, 2, 3, 3, 1, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 2, 1, 3, 2, 3, 1, 1, 1, 2, 1, 3, 3, 2, 1, 3, 1, 1, 3, 1, 3, 2, 1, 3, 3, 2, 2, 3, 3, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 2, 2, 1, 1, 3, 1, 1, 3, 2, 2, 2, 1, 3, 1, 2, 1, 1, 1, 3, 2, 1, 1, 3, 3, 1, 1, 3, 1, 2, 2, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 3, 1, 2, 3, 1, 1, 3, 3, 2, 1, 2, 2, 3]
02/23/2023 13:10:07:INFO: ---------Evaluated Metrics----------
02/23/2023 13:10:07:INFO: Accuracy: 0.48.
02/23/2023 13:10:07:INFO: Macro Precision: 0.4193777110443777.
02/23/2023 13:10:07:INFO: Macro Recall: 0.40708183221821925.
02/23/2023 13:10:07:INFO: Macro F1 score: 0.4033507191401928.
02/23/2023 13:10:07:INFO: ---------confusion_matrix----------
02/23/2023 13:10:07:INFO: 
[[48 12  7]
 [11  4 10]
 [22 16 20]]
02/23/2023 13:10:07:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:10:07:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:10:07:INFO: --------------Epoch. 3.---------------
02/23/2023 13:10:07:INFO: [Epoch. 3.]: 100%|| 8/8 [00:00<00:00, 16.12it/s, avg_loss=0.95]
02/23/2023 13:10:07:INFO: Epoch 3, average loss: 0.9498604722321033
02/23/2023 13:10:07:INFO: --------------Evaluate on Epoch. 3.---------------
02/23/2023 13:10:07:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:10:08:INFO: **********Results Comparison**********
02/23/2023 13:10:08:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:10:08:INFO: 预测标签: 
 [3, 1, 3, 3, 2, 1, 3, 3, 3, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 3, 3, 2, 3, 3, 3, 1, 2, 3, 1, 1, 1, 3, 2, 1, 1, 2, 3, 3, 1, 1, 2, 2, 3, 1, 1, 3, 1, 3, 3, 2, 2, 1, 3, 2, 3, 1, 1, 3, 3, 1, 3, 3, 2, 3, 3, 3, 1, 3, 1, 3, 3, 1, 3, 3, 3, 2, 3, 3, 1, 3, 1, 1, 3, 1, 1, 3, 3, 1, 1, 1, 3, 3, 1, 3, 3, 1, 3, 2, 2, 1, 1, 3, 3, 3, 3, 3, 2, 2, 3, 3, 1, 2, 1, 1, 1, 3, 3, 1, 1, 3, 3, 1, 3, 3, 3, 2, 2, 3, 1, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 3, 3, 1, 1, 3, 3, 3, 1, 2, 2, 3]
02/23/2023 13:10:08:INFO: ---------Evaluated Metrics----------
02/23/2023 13:10:08:INFO: Accuracy: 0.58.
02/23/2023 13:10:08:INFO: Macro Precision: 0.4940771740672436.
02/23/2023 13:10:08:INFO: Macro Recall: 0.4911065362840968.
02/23/2023 13:10:08:INFO: Macro F1 score: 0.48518638690604954.
02/23/2023 13:10:08:INFO: ---------confusion_matrix----------
02/23/2023 13:10:08:INFO: 
[[41  9 17]
 [ 6  3 16]
 [ 6  9 43]]
02/23/2023 13:10:08:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:10:08:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:10:08:INFO: --------------Epoch. 4.---------------
02/23/2023 13:10:09:INFO: [Epoch. 4.]: 100%|| 8/8 [00:00<00:00, 16.60it/s, avg_loss=0.679]
02/23/2023 13:10:09:INFO: Epoch 4, average loss: 0.6794689502567053
02/23/2023 13:10:09:INFO: --------------Evaluate on Epoch. 4.---------------
02/23/2023 13:10:09:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:10:09:INFO: **********Results Comparison**********
02/23/2023 13:10:09:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:10:09:INFO: 预测标签: 
 [3, 1, 3, 3, 2, 1, 3, 3, 3, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 3, 3, 2, 3, 3, 3, 1, 2, 3, 2, 3, 1, 3, 2, 1, 1, 2, 3, 3, 1, 1, 2, 2, 3, 3, 1, 3, 3, 3, 3, 2, 2, 2, 3, 2, 3, 3, 1, 3, 2, 2, 3, 3, 2, 3, 3, 3, 1, 3, 2, 3, 3, 1, 3, 3, 3, 2, 3, 3, 3, 3, 3, 1, 3, 1, 1, 3, 3, 3, 1, 1, 3, 3, 1, 3, 3, 3, 3, 2, 2, 1, 3, 3, 3, 3, 3, 3, 2, 2, 3, 3, 1, 2, 1, 3, 1, 3, 3, 1, 1, 3, 3, 1, 3, 3, 3, 2, 2, 3, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 3, 3, 3, 1, 3, 3, 3, 3, 2, 2, 3]
02/23/2023 13:10:09:INFO: ---------Evaluated Metrics----------
02/23/2023 13:10:09:INFO: Accuracy: 0.52.
02/23/2023 13:10:09:INFO: Macro Precision: 0.4866938616938617.
02/23/2023 13:10:09:INFO: Macro Recall: 0.44787442099845604.
02/23/2023 13:10:09:INFO: Macro F1 score: 0.4388698956108577.
02/23/2023 13:10:09:INFO: ---------confusion_matrix----------
02/23/2023 13:10:09:INFO: 
[[30 13 24]
 [ 3  3 19]
 [ 3 10 45]]
02/23/2023 13:10:09:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:10:09:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:10:09:INFO: --------------Epoch. 5.---------------
02/23/2023 13:10:10:INFO: [Epoch. 5.]: 100%|| 8/8 [00:00<00:00, 16.70it/s, avg_loss=0.499]
02/23/2023 13:10:10:INFO: Epoch 5, average loss: 0.49909721314907074
02/23/2023 13:10:10:INFO: --------------Evaluate on Epoch. 5.---------------
02/23/2023 13:10:10:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:10:11:INFO: **********Results Comparison**********
02/23/2023 13:10:11:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:10:11:INFO: 预测标签: 
 [3, 2, 3, 3, 2, 1, 3, 3, 3, 1, 3, 3, 1, 1, 3, 3, 3, 3, 3, 3, 3, 2, 3, 3, 3, 1, 2, 3, 2, 3, 1, 3, 2, 3, 1, 2, 3, 3, 1, 1, 2, 2, 3, 3, 1, 3, 3, 2, 3, 2, 2, 2, 3, 2, 3, 3, 3, 3, 2, 2, 3, 3, 2, 3, 2, 3, 1, 3, 2, 3, 2, 1, 3, 3, 3, 2, 3, 3, 3, 3, 3, 1, 3, 1, 2, 3, 3, 3, 1, 1, 3, 3, 1, 3, 2, 3, 3, 2, 2, 3, 3, 3, 3, 3, 3, 3, 2, 2, 3, 3, 1, 2, 1, 3, 1, 3, 3, 2, 1, 2, 3, 2, 3, 3, 3, 2, 2, 3, 3, 1, 3, 3, 3, 1, 3, 1, 1, 3, 1, 3, 3, 2, 3, 3, 3, 3, 3, 2, 2, 3]
02/23/2023 13:10:11:INFO: ---------Evaluated Metrics----------
02/23/2023 13:10:11:INFO: Accuracy: 0.4533333333333333.
02/23/2023 13:10:11:INFO: Macro Precision: 0.47817922817922814.
02/23/2023 13:10:11:INFO: Macro Recall: 0.40416537999656893.
02/23/2023 13:10:11:INFO: Macro F1 score: 0.3932027621023079.
02/23/2023 13:10:11:INFO: ---------confusion_matrix----------
02/23/2023 13:10:11:INFO: 
[[22 17 28]
 [ 3  4 18]
 [ 1 15 42]]
02/23/2023 13:10:11:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:10:11:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:10:11:INFO: --------------Epoch. 6.---------------
02/23/2023 13:10:11:INFO: [Epoch. 6.]: 100%|| 8/8 [00:00<00:00, 16.77it/s, avg_loss=0.389]
02/23/2023 13:10:11:INFO: Epoch 6, average loss: 0.38946338929235935
02/23/2023 13:10:11:INFO: --------------Evaluate on Epoch. 6.---------------
02/23/2023 13:10:11:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:10:12:INFO: **********Results Comparison**********
02/23/2023 13:10:12:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:10:12:INFO: 预测标签: 
 [2, 2, 3, 3, 2, 2, 2, 3, 3, 1, 2, 3, 1, 1, 2, 3, 2, 3, 3, 3, 2, 2, 3, 3, 3, 1, 2, 3, 2, 2, 2, 2, 2, 3, 1, 2, 3, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 3, 2, 3, 3, 3, 3, 2, 2, 3, 3, 2, 3, 2, 3, 1, 3, 2, 3, 2, 2, 2, 3, 2, 2, 3, 3, 3, 2, 2, 1, 3, 1, 2, 2, 3, 2, 1, 2, 3, 3, 2, 3, 2, 3, 3, 2, 2, 2, 2, 3, 3, 2, 3, 2, 2, 2, 3, 3, 2, 2, 1, 3, 1, 3, 2, 2, 2, 2, 3, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 1, 2, 3, 1, 2, 3, 2, 3, 3, 2, 2, 3, 2, 2, 3]
02/23/2023 13:10:12:INFO: ---------Evaluated Metrics----------
02/23/2023 13:10:12:INFO: Accuracy: 0.37333333333333335.
02/23/2023 13:10:12:INFO: Macro Precision: 0.5412311265969802.
02/23/2023 13:10:12:INFO: Macro Recall: 0.43318236404185967.
02/23/2023 13:10:12:INFO: Macro F1 score: 0.3673986440081975.
02/23/2023 13:10:12:INFO: ---------confusion_matrix----------
02/23/2023 13:10:12:INFO: 
[[13 36 18]
 [ 0 16  9]
 [ 1 30 27]]
02/23/2023 13:10:12:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:10:12:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:10:12:INFO: --------------Epoch. 7.---------------
02/23/2023 13:10:12:INFO: [Epoch. 7.]: 100%|| 8/8 [00:00<00:00, 16.55it/s, avg_loss=0.382]
02/23/2023 13:10:12:INFO: Epoch 7, average loss: 0.3815689906477928
02/23/2023 13:10:12:INFO: --------------Evaluate on Epoch. 7.---------------
02/23/2023 13:10:12:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:10:13:INFO: **********Results Comparison**********
02/23/2023 13:10:13:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:10:13:INFO: 预测标签: 
 [2, 2, 3, 3, 2, 2, 2, 2, 3, 2, 2, 3, 2, 2, 2, 3, 2, 2, 3, 2, 2, 2, 3, 3, 3, 1, 2, 3, 2, 2, 2, 2, 2, 2, 1, 2, 3, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 3, 2, 3, 3, 2, 3, 2, 2, 3, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 2, 2, 2, 2, 2, 3, 3, 3, 2, 2, 2, 2, 1, 2, 2, 3, 2, 1, 2, 3, 3, 2, 2, 2, 3, 3, 2, 2, 2, 2, 3, 3, 2, 3, 2, 2, 2, 2, 2, 2, 2, 1, 3, 1, 3, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 3, 1, 2, 3, 2, 3, 3, 2, 2, 3, 2, 2, 3]
02/23/2023 13:10:13:INFO: ---------Evaluated Metrics----------
02/23/2023 13:10:13:INFO: Accuracy: 0.32.
02/23/2023 13:10:13:INFO: Macro Precision: 0.5600970949808158.
02/23/2023 13:10:13:INFO: Macro Recall: 0.4138239835306228.
02/23/2023 13:10:13:INFO: Macro F1 score: 0.3118755101316583.
02/23/2023 13:10:13:INFO: ---------confusion_matrix----------
02/23/2023 13:10:13:INFO: 
[[ 8 43 16]
 [ 0 19  6]
 [ 0 37 21]]
02/23/2023 13:10:13:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:10:13:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:10:13:INFO: --------------Epoch. 8.---------------
02/23/2023 13:10:14:INFO: [Epoch. 8.]: 100%|| 8/8 [00:00<00:00, 16.81it/s, avg_loss=0.336]
02/23/2023 13:10:14:INFO: Epoch 8, average loss: 0.3358667269349098
02/23/2023 13:10:14:INFO: --------------Evaluate on Epoch. 8.---------------
02/23/2023 13:10:14:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:10:14:INFO: **********Results Comparison**********
02/23/2023 13:10:14:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:10:14:INFO: 预测标签: 
 [2, 2, 3, 3, 2, 2, 2, 2, 3, 1, 2, 3, 1, 2, 2, 3, 2, 2, 3, 2, 2, 2, 3, 3, 3, 1, 2, 3, 2, 3, 2, 2, 2, 3, 1, 2, 3, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 3, 2, 3, 3, 3, 3, 2, 2, 3, 3, 2, 3, 2, 3, 1, 3, 2, 3, 2, 2, 2, 3, 2, 2, 3, 3, 3, 2, 2, 1, 3, 1, 2, 2, 3, 2, 1, 2, 3, 3, 2, 3, 2, 3, 3, 2, 2, 2, 2, 3, 3, 2, 3, 2, 2, 2, 2, 3, 2, 2, 1, 3, 1, 3, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 1, 2, 3, 1, 2, 3, 2, 3, 3, 2, 2, 3, 2, 2, 3]
02/23/2023 13:10:14:INFO: ---------Evaluated Metrics----------
02/23/2023 13:10:14:INFO: Accuracy: 0.36666666666666664.
02/23/2023 13:10:14:INFO: Macro Precision: 0.5622988505747126.
02/23/2023 13:10:14:INFO: Macro Recall: 0.44260765139818153.
02/23/2023 13:10:14:INFO: Macro F1 score: 0.36362433862433857.
02/23/2023 13:10:14:INFO: ---------confusion_matrix----------
02/23/2023 13:10:14:INFO: 
[[13 35 19]
 [ 0 18  7]
 [ 0 34 24]]
02/23/2023 13:10:14:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:10:14:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:10:14:INFO: --------------Epoch. 9.---------------
02/23/2023 13:10:15:INFO: [Epoch. 9.]: 100%|| 8/8 [00:00<00:00, 16.84it/s, avg_loss=0.304]
02/23/2023 13:10:15:INFO: Epoch 9, average loss: 0.3037972832098603
02/23/2023 13:10:15:INFO: --------------Evaluate on Epoch. 9.---------------
02/23/2023 13:10:15:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:10:16:INFO: **********Results Comparison**********
02/23/2023 13:10:16:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:10:16:INFO: 预测标签: 
 [2, 2, 3, 3, 2, 2, 2, 3, 3, 1, 2, 3, 1, 1, 2, 3, 2, 2, 3, 3, 2, 2, 3, 3, 3, 1, 2, 3, 2, 3, 2, 2, 2, 3, 1, 2, 3, 2, 1, 1, 2, 2, 2, 2, 2, 3, 2, 2, 3, 2, 2, 2, 3, 2, 3, 3, 3, 3, 2, 2, 3, 3, 2, 3, 2, 3, 1, 3, 2, 3, 2, 2, 2, 3, 2, 2, 3, 3, 3, 2, 2, 1, 3, 1, 2, 2, 3, 2, 1, 2, 3, 3, 2, 3, 2, 3, 3, 2, 2, 2, 2, 3, 3, 2, 3, 2, 2, 2, 2, 3, 2, 2, 1, 3, 1, 3, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 1, 2, 3, 1, 2, 3, 2, 3, 3, 2, 2, 3, 2, 2, 3]
02/23/2023 13:10:16:INFO: ---------Evaluated Metrics----------
02/23/2023 13:10:16:INFO: Accuracy: 0.35333333333333333.
02/23/2023 13:10:16:INFO: Macro Precision: 0.5230301170936237.
02/23/2023 13:10:16:INFO: Macro Recall: 0.40758277577629093.
02/23/2023 13:10:16:INFO: Macro F1 score: 0.3514232262807599.
02/23/2023 13:10:16:INFO: ---------confusion_matrix----------
02/23/2023 13:10:16:INFO: 
[[14 34 19]
 [ 0 15 10]
 [ 1 33 24]]
02/23/2023 13:10:16:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:10:16:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:10:16:INFO: Based on [4.th Epoch] best_accuracy: 0.58.
02/23/2023 13:10:16:INFO: latest 5 epochs not seen performance increased, early stop.
02/23/2023 13:10:16:INFO: ********** Best Results on Dev Dataset **********
02/23/2023 13:10:16:INFO: Best Accuracy: 0.58.
02/23/2023 13:10:16:INFO: Best Macro Precision: 0.4940771740672436.
02/23/2023 13:10:16:INFO: Best Macro Recall: 0.4911065362840968.
02/23/2023 13:10:16:INFO: Best Macro F1 score: 0.48518638690604954.
02/23/2023 13:10:16:INFO: ***** Training Over *****
02/23/2023 13:10:16:INFO: --------------Testing ...---------------
02/23/2023 13:10:16:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:10:17:INFO: **********Results Comparison**********
02/23/2023 13:10:17:INFO: 真实标签: 
 [1, 3, 1, 3, 1, 2, 1, 1, 1, 1, 3, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 3, 1, 3, 3, 1, 1, 1, 1, 1, 1, 3, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 1, 3, 2, 1, 1, 1, 3, 2, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 2, 1, 1, 1, 3, 1, 3, 2, 3, 1, 1, 1, 1, 1, 3, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 3, 1, 2, 3, 3, 1, 3, 1, 1, 3, 3, 1, 1, 1, 2, 2, 3, 2, 3, 2, 2, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 3, 2, 1, 1, 1, 2, 3, 2, 3, 3, 3, 3, 3, 3, 1, 2, 2, 1, 1, 1, 1, 1, 1, 2, 3, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 2, 1, 2, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 3, 1, 1, 1, 1, 2, 2, 3, 1, 1, 1, 1, 1, 3, 2, 2, 1, 1, 1, 1, 1, 1, 3, 2, 3, 1, 1, 2, 2, 1, 2, 2, 1, 3, 2, 1, 1, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 2, 2, 1, 3, 1, 3, 1, 1, 1, 3, 2, 1, 2, 2, 1, 2, 1, 1, 1, 1, 2, 3, 2, 2, 1, 3, 1, 2, 1, 2, 1, 3, 3, 1, 1, 1, 1, 3, 1, 3, 1, 1, 1, 2, 1, 1, 2, 2, 3, 3, 2, 1, 1, 2, 3, 1, 1, 2, 3, 2, 2, 2, 2, 2, 3, 2, 3, 1, 1, 1, 3, 1, 3, 2, 1, 1, 1, 1, 1, 2, 1, 3, 3, 1, 1, 1, 2, 2, 2, 2, 2, 3, 1, 1, 1, 1, 2, 2, 1, 2, 2, 2, 2, 2, 3, 2, 1, 3, 1, 2, 1, 2, 1, 3, 2, 1, 1, 1, 2, 2, 1, 1, 1, 1, 2, 3, 2, 2, 1, 1, 1, 1, 2, 2, 3, 1, 1, 3, 2, 3, 2, 2, 2, 1, 1, 2, 1, 1, 3, 1, 2, 2, 1, 2, 3, 1, 1, 3, 1, 2, 2, 1]
02/23/2023 13:10:17:INFO: 预测标签: 
 [2, 2, 2, 2, 2, 2, 1, 2, 1, 2, 2, 3, 3, 1, 2, 1, 3, 2, 2, 2, 3, 3, 1, 2, 2, 1, 3, 2, 1, 2, 3, 1, 3, 3, 1, 2, 1, 2, 1, 3, 3, 2, 2, 3, 1, 2, 2, 2, 2, 2, 2, 1, 1, 2, 3, 3, 3, 1, 3, 2, 2, 2, 1, 1, 1, 1, 2, 2, 1, 3, 2, 1, 3, 2, 3, 2, 3, 2, 3, 2, 2, 1, 3, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 1, 2, 2, 2, 3, 2, 3, 3, 3, 3, 3, 1, 1, 2, 3, 3, 1, 2, 2, 3, 3, 2, 3, 3, 3, 2, 2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 3, 2, 3, 2, 3, 3, 1, 2, 2, 2, 2, 3, 2, 2, 3, 2, 1, 1, 2, 2, 2, 3, 2, 2, 2, 1, 3, 2, 3, 1, 3, 2, 3, 3, 2, 2, 2, 2, 2, 2, 2, 1, 3, 2, 3, 2, 2, 2, 2, 3, 2, 2, 3, 2, 1, 2, 3, 2, 3, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 2, 2, 3, 1, 2, 3, 3, 2, 3, 2, 2, 2, 3, 3, 3, 2, 2, 2, 2, 2, 1, 3, 2, 2, 2, 2, 2, 2, 3, 1, 1, 3, 3, 2, 1, 3, 2, 1, 2, 3, 2, 2, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 1, 2, 3, 2, 3, 2, 1, 2, 3, 2, 3, 2, 2, 1, 3, 1, 2, 1, 3, 2, 2, 3, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 3, 2, 2, 2, 2, 2, 3, 2, 2, 3, 3, 3, 2, 2, 3, 2, 2, 3, 2, 3, 2, 2, 2, 2, 3, 2, 2, 3, 3, 2, 2, 2, 2, 2, 1, 2, 3, 3, 2, 2, 1, 1, 2, 3, 3, 2, 2, 2, 2, 2, 3, 2, 2, 1, 3, 3, 3, 2, 2, 3, 1, 1, 2, 2, 2, 3, 3, 1, 2, 2, 2, 3, 3, 2, 3, 2, 2, 2, 1, 2, 3, 2, 2, 1, 1, 2, 2, 3, 1, 2, 2, 2, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 3, 2, 2, 3, 2, 2, 2, 2, 3]
02/23/2023 13:10:17:INFO: ---------Evaluated Metrics----------
02/23/2023 13:10:17:INFO: Accuracy: 0.3594132029339853.
02/23/2023 13:10:17:INFO: Macro Precision: 0.4846745595973461.
02/23/2023 13:10:17:INFO: Macro Recall: 0.4182785299806577.
02/23/2023 13:10:17:INFO: Macro F1 score: 0.3599403162615711.
02/23/2023 13:10:17:INFO: ---------confusion_matrix----------
02/23/2023 13:10:17:INFO: 
[[ 56 130  45]
 [  6  56  32]
 [  0  49  35]]
02/23/2023 13:10:17:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:10:17:INFO: ----------------------Testing finished.------------------------
02/23/2023 13:10:17:INFO: bengio.
