02/23/2023 13:24:04:INFO: start.
02/23/2023 13:24:04:INFO: --------hyper-arguments for this training.--------
02/23/2023 13:24:04:INFO: Namespace(answer_strategy='inter_logits_core_token', batch_size=2, dataset='rest16', eval_pre_epochs=1, few_shot=5, learning_rate=1e-05, log_file=None, model_type='WT2ABSA_Mean', patience=5, pre_trained_model='pretrainedmodels/bert-base-cased', save_best_model=False, seed=985, total_epochs=20)
02/23/2023 13:24:04:INFO: ----------dataset files------------
02/23/2023 13:24:04:INFO: {'train': '../WordTrans2ABSA/dataset/rest16/train.json', 'dev': '../WordTrans2ABSA/dataset/rest16/dev.json', 'test': '../WordTrans2ABSA/dataset/rest16/test.json'}
02/23/2023 13:24:07:WARNING: Using custom data configuration default-b3ccb5991d649a97
02/23/2023 13:24:07:WARNING: Reusing dataset json (C:\Users\Super-IdoI\.cache\huggingface\datasets\json\default-b3ccb5991d649a97\0.0.0\45636811569ec4a6630521c18235dfbbab83b7ab572e3393c5ba68ccabe98264)
02/23/2023 13:24:07:INFO: -----------------------------------
02/23/2023 13:24:07:INFO: {'I-POS': ['good', 'clever', 'excellent', 'effectual', 'beautiful', 'nice', 'useful', 'well', 'fantastic'], 'I-NEU': ['Michael', 'John', 'David', 'Thomas', 'Martin', 'Paul'], 'I-NEG': ['bad', 'terrible', 'awful', 'badly', 'terrible', 'poor', 'unfortunate', 'harmful', 'dirty', 'sorry']}
02/23/2023 13:24:07:INFO: -----------------------------------
02/23/2023 13:24:07:INFO: {'O': 0, 'I-POS': 1, 'I-NEU': 2, 'I-NEG': 3}
02/23/2023 13:24:07:INFO: {0: 'O', 1: 'I-POS', 2: 'I-NEU', 3: 'I-NEG'}
02/23/2023 13:24:09:INFO: -----------------------------------
02/23/2023 13:24:09:INFO: {'I-POS': 28996, 'I-NEU': 28997, 'I-NEG': 28998}
02/23/2023 13:24:09:INFO: {28996: 'I-POS', 28997: 'I-NEU', 28998: 'I-NEG'}
02/23/2023 13:24:09:INFO: start preprocess dataset.
02/23/2023 13:24:09:WARNING: Loading cached processed dataset at C:\Users\Super-IdoI\.cache\huggingface\datasets\json\default-b3ccb5991d649a97\0.0.0\45636811569ec4a6630521c18235dfbbab83b7ab572e3393c5ba68ccabe98264\cache-bfb4623d1a697f0a.arrow
02/23/2023 13:24:10:WARNING: Loading cached processed dataset at C:\Users\Super-IdoI\.cache\huggingface\datasets\json\default-b3ccb5991d649a97\0.0.0\45636811569ec4a6630521c18235dfbbab83b7ab572e3393c5ba68ccabe98264\cache-c5fba34f105b77a0.arrow
02/23/2023 13:24:10:INFO: dataset preprocess finished.
02/23/2023 13:24:10:WARNING: Loading cached processed dataset at C:\Users\Super-IdoI\.cache\huggingface\datasets\json\default-b3ccb5991d649a97\0.0.0\45636811569ec4a6630521c18235dfbbab83b7ab572e3393c5ba68ccabe98264\cache-fce38af0f10a9bea.arrow
02/23/2023 13:24:10:INFO: Train: 15, Dev: 118, Test: 418.
02/23/2023 13:24:10:INFO: dataloader prepare finished.
02/23/2023 13:24:10:INFO: ***** Start Training *****
02/23/2023 13:24:10:INFO: Total Epochs: 20
02/23/2023 13:24:10:INFO: validate on per-1 epochs.
02/23/2023 13:24:10:INFO: Training Samples Count: 15.
02/23/2023 13:24:10:INFO: Batch Size: 2, 每轮 8 Batch.
02/23/2023 13:24:10:INFO: Learning Rate: 1e-05
02/23/2023 13:24:10:INFO: --------------Epoch. 1.---------------
02/23/2023 13:24:10:INFO: [Epoch. 1.]: 100%|| 8/8 [00:00<00:00, 12.14it/s, avg_loss=1.79]
02/23/2023 13:24:10:INFO: Epoch 1, average loss: 1.785299964249134
02/23/2023 13:24:10:INFO: --------------Evaluate on Epoch. 1.---------------
02/23/2023 13:24:10:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:24:11:INFO: **********Results Comparison**********
02/23/2023 13:24:11:INFO: 真实标签: 
 [1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 1, 1, 3, 1, 1, 3, 2, 1, 1, 1, 3, 1, 3, 3, 3, 1, 2, 3, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 2, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 2, 2, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1]
02/23/2023 13:24:11:INFO: 预测标签: 
 [1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 3, 1, 1, 2, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 2, 2, 2, 2, 2, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 2, 2, 3, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 2, 2, 1, 1]
02/23/2023 13:24:11:INFO: ---------Evaluated Metrics----------
02/23/2023 13:24:11:INFO: Accuracy: 0.5677966101694916.
02/23/2023 13:24:11:INFO: Macro Precision: 0.3511494252873563.
02/23/2023 13:24:11:INFO: Macro Recall: 0.4003765227021041.
02/23/2023 13:24:11:INFO: Macro F1 score: 0.32483660130718955.
02/23/2023 13:24:11:INFO: ---------confusion_matrix----------
02/23/2023 13:24:11:INFO: 
[[63 20  3]
 [ 3  3  1]
 [18  6  1]]
02/23/2023 13:24:11:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:24:11:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:24:11:INFO: --------------Epoch. 2.---------------
02/23/2023 13:24:11:INFO: [Epoch. 2.]: 100%|| 8/8 [00:00<00:00, 15.65it/s, avg_loss=0.987]
02/23/2023 13:24:11:INFO: Epoch 2, average loss: 0.98735760897398
02/23/2023 13:24:11:INFO: --------------Evaluate on Epoch. 2.---------------
02/23/2023 13:24:11:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:24:12:INFO: **********Results Comparison**********
02/23/2023 13:24:12:INFO: 真实标签: 
 [1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 1, 1, 3, 1, 1, 3, 2, 1, 1, 1, 3, 1, 3, 3, 3, 1, 2, 3, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 2, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 2, 2, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1]
02/23/2023 13:24:12:INFO: 预测标签: 
 [1, 3, 3, 1, 1, 3, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 3, 3, 3, 1, 1, 1, 1, 1, 3, 1, 2, 2, 1, 1, 1, 3, 1, 3, 2, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 2, 2, 3, 1, 1, 1, 1, 1, 1, 1, 2, 1, 3, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1]
02/23/2023 13:24:12:INFO: ---------Evaluated Metrics----------
02/23/2023 13:24:12:INFO: Accuracy: 0.5932203389830508.
02/23/2023 13:24:12:INFO: Macro Precision: 0.46306471306471303.
02/23/2023 13:24:12:INFO: Macro Recall: 0.4592912513842746.
02/23/2023 13:24:12:INFO: Macro F1 score: 0.41321844492576204.
02/23/2023 13:24:12:INFO: ---------confusion_matrix----------
02/23/2023 13:24:12:INFO: 
[[61 20  5]
 [ 3  3  1]
 [14  5  6]]
02/23/2023 13:24:12:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:24:12:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:24:12:INFO: --------------Epoch. 3.---------------
02/23/2023 13:24:12:INFO: [Epoch. 3.]: 100%|| 8/8 [00:00<00:00, 16.45it/s, avg_loss=0.872]
02/23/2023 13:24:12:INFO: Epoch 3, average loss: 0.8716309703886509
02/23/2023 13:24:12:INFO: --------------Evaluate on Epoch. 3.---------------
02/23/2023 13:24:12:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:24:13:INFO: **********Results Comparison**********
02/23/2023 13:24:13:INFO: 真实标签: 
 [1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 1, 1, 3, 1, 1, 3, 2, 1, 1, 1, 3, 1, 3, 3, 3, 1, 2, 3, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 2, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 2, 2, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1]
02/23/2023 13:24:13:INFO: 预测标签: 
 [1, 3, 3, 1, 1, 3, 2, 1, 2, 1, 2, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 1, 3, 3, 3, 1, 1, 1, 1, 1, 3, 3, 2, 2, 1, 1, 1, 3, 1, 3, 2, 1, 2, 2, 2, 3, 1, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 1, 3, 1, 2, 1, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 1, 2, 3, 1, 1, 1, 3, 2, 1, 2, 3, 2, 2, 2, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 3, 2, 1, 1]
02/23/2023 13:24:13:INFO: ---------Evaluated Metrics----------
02/23/2023 13:24:13:INFO: Accuracy: 0.6186440677966102.
02/23/2023 13:24:13:INFO: Macro Precision: 0.5037037037037037.
02/23/2023 13:24:13:INFO: Macro Recall: 0.5276633444075304.
02/23/2023 13:24:13:INFO: Macro F1 score: 0.4805998207532734.
02/23/2023 13:24:13:INFO: ---------confusion_matrix----------
02/23/2023 13:24:13:INFO: 
[[58 20  8]
 [ 3  3  1]
 [ 9  4 12]]
02/23/2023 13:24:13:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:24:13:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:24:13:INFO: --------------Epoch. 4.---------------
02/23/2023 13:24:13:INFO: [Epoch. 4.]: 100%|| 8/8 [00:00<00:00, 16.61it/s, avg_loss=0.64]
02/23/2023 13:24:13:INFO: Epoch 4, average loss: 0.6395092308521271
02/23/2023 13:24:13:INFO: --------------Evaluate on Epoch. 4.---------------
02/23/2023 13:24:13:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:24:14:INFO: **********Results Comparison**********
02/23/2023 13:24:14:INFO: 真实标签: 
 [1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 1, 1, 3, 1, 1, 3, 2, 1, 1, 1, 3, 1, 3, 3, 3, 1, 2, 3, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 2, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 2, 2, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1]
02/23/2023 13:24:14:INFO: 预测标签: 
 [3, 3, 3, 1, 1, 3, 2, 1, 2, 1, 2, 1, 1, 3, 3, 3, 2, 1, 1, 1, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 3, 3, 2, 2, 1, 1, 1, 3, 1, 3, 2, 1, 1, 2, 2, 3, 1, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 1, 3, 1, 2, 1, 1, 1, 2, 2, 2, 2, 3, 2, 2, 1, 3, 2, 3, 1, 1, 1, 3, 2, 3, 2, 3, 2, 2, 2, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 3, 2, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1, 3, 2, 1, 1, 3, 2, 1, 1]
02/23/2023 13:24:14:INFO: ---------Evaluated Metrics----------
02/23/2023 13:24:14:INFO: Accuracy: 0.5677966101694916.
02/23/2023 13:24:14:INFO: Macro Precision: 0.4601553166069295.
02/23/2023 13:24:14:INFO: Macro Recall: 0.5138648947951273.
02/23/2023 13:24:14:INFO: Macro F1 score: 0.4464621465024366.
02/23/2023 13:24:14:INFO: ---------confusion_matrix----------
02/23/2023 13:24:14:INFO: 
[[51 20 15]
 [ 1  3  3]
 [ 8  4 13]]
02/23/2023 13:24:14:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:24:14:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:24:14:INFO: --------------Epoch. 5.---------------
02/23/2023 13:24:14:INFO: [Epoch. 5.]: 100%|| 8/8 [00:00<00:00, 16.63it/s, avg_loss=0.506]
02/23/2023 13:24:14:INFO: Epoch 5, average loss: 0.5060766898095608
02/23/2023 13:24:14:INFO: --------------Evaluate on Epoch. 5.---------------
02/23/2023 13:24:14:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:24:15:INFO: **********Results Comparison**********
02/23/2023 13:24:15:INFO: 真实标签: 
 [1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 1, 1, 3, 1, 1, 3, 2, 1, 1, 1, 3, 1, 3, 3, 3, 1, 2, 3, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 2, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 2, 2, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1]
02/23/2023 13:24:15:INFO: 预测标签: 
 [3, 3, 3, 2, 1, 3, 2, 1, 2, 2, 2, 1, 1, 3, 3, 3, 2, 1, 1, 3, 3, 3, 3, 3, 3, 1, 1, 2, 3, 2, 3, 3, 2, 2, 2, 1, 2, 3, 2, 2, 2, 1, 2, 2, 2, 3, 1, 2, 2, 2, 1, 3, 2, 2, 1, 1, 1, 1, 3, 1, 2, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 1, 3, 2, 3, 1, 1, 2, 3, 2, 3, 2, 3, 2, 2, 2, 3, 2, 1, 2, 1, 1, 1, 2, 2, 2, 3, 1, 3, 2, 1, 3, 1, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 1, 2, 2, 1, 1]
02/23/2023 13:24:15:INFO: ---------Evaluated Metrics----------
02/23/2023 13:24:15:INFO: Accuracy: 0.423728813559322.
02/23/2023 13:24:15:INFO: Macro Precision: 0.46183409843066076.
02/23/2023 13:24:15:INFO: Macro Recall: 0.4290586932447398.
02/23/2023 13:24:15:INFO: Macro F1 score: 0.3638336148532663.
02/23/2023 13:24:15:INFO: ---------confusion_matrix----------
02/23/2023 13:24:15:INFO: 
[[36 35 15]
 [ 1  3  3]
 [ 1 13 11]]
02/23/2023 13:24:15:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:24:15:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:24:15:INFO: --------------Epoch. 6.---------------
02/23/2023 13:24:15:INFO: [Epoch. 6.]: 100%|| 8/8 [00:00<00:00, 16.80it/s, avg_loss=0.392]
02/23/2023 13:24:15:INFO: Epoch 6, average loss: 0.3916935231536627
02/23/2023 13:24:15:INFO: --------------Evaluate on Epoch. 6.---------------
02/23/2023 13:24:16:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:24:16:INFO: **********Results Comparison**********
02/23/2023 13:24:16:INFO: 真实标签: 
 [1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 1, 1, 3, 1, 1, 3, 2, 1, 1, 1, 3, 1, 3, 3, 3, 1, 2, 3, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 2, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 2, 2, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1]
02/23/2023 13:24:16:INFO: 预测标签: 
 [3, 3, 2, 2, 1, 3, 2, 2, 2, 2, 2, 2, 1, 3, 2, 2, 2, 1, 2, 2, 3, 2, 3, 3, 3, 2, 2, 2, 3, 2, 3, 3, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 1, 3, 2, 2, 1, 2, 1, 1, 3, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 1, 2, 2, 2, 2, 3, 2, 3, 2, 2, 2, 3, 2, 1, 2, 2, 2, 1, 2, 2, 2, 3, 2, 2, 2, 1, 3, 1, 1, 1, 2, 1, 2, 1, 2, 2, 2, 2, 1, 2, 2, 1, 2]
02/23/2023 13:24:16:INFO: ---------Evaluated Metrics----------
02/23/2023 13:24:16:INFO: Accuracy: 0.2711864406779661.
02/23/2023 13:24:16:INFO: Macro Precision: 0.44726770813727335.
02/23/2023 13:24:16:INFO: Macro Recall: 0.35574750830564783.
02/23/2023 13:24:16:INFO: Macro F1 score: 0.2593258624835326.
02/23/2023 13:24:16:INFO: ---------confusion_matrix----------
02/23/2023 13:24:16:INFO: 
[[22 54 10]
 [ 1  4  2]
 [ 0 19  6]]
02/23/2023 13:24:16:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:24:16:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:24:16:INFO: --------------Epoch. 7.---------------
02/23/2023 13:24:17:INFO: [Epoch. 7.]: 100%|| 8/8 [00:00<00:00, 16.62it/s, avg_loss=0.416]
02/23/2023 13:24:17:INFO: Epoch 7, average loss: 0.4161314573138952
02/23/2023 13:24:17:INFO: --------------Evaluate on Epoch. 7.---------------
02/23/2023 13:24:17:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:24:17:INFO: **********Results Comparison**********
02/23/2023 13:24:17:INFO: 真实标签: 
 [1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 1, 1, 3, 1, 1, 3, 2, 1, 1, 1, 3, 1, 3, 3, 3, 1, 2, 3, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 2, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 2, 2, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1]
02/23/2023 13:24:17:INFO: 预测标签: 
 [1, 3, 2, 2, 1, 3, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 1, 2, 2, 3, 2, 3, 3, 3, 2, 2, 2, 1, 2, 3, 3, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 3, 2, 2, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 3, 2, 1, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 1, 3, 1, 1, 1, 2, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 1, 2]
02/23/2023 13:24:17:INFO: ---------Evaluated Metrics----------
02/23/2023 13:24:17:INFO: Accuracy: 0.2457627118644068.
02/23/2023 13:24:17:INFO: Macro Precision: 0.47539682539682543.
02/23/2023 13:24:17:INFO: Macro Recall: 0.3441196013289036.
02/23/2023 13:24:17:INFO: Macro F1 score: 0.2513649872140438.
02/23/2023 13:24:17:INFO: ---------confusion_matrix----------
02/23/2023 13:24:17:INFO: 
[[19 61  6]
 [ 1  4  2]
 [ 0 19  6]]
02/23/2023 13:24:17:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:24:17:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:24:17:INFO: --------------Epoch. 8.---------------
02/23/2023 13:24:18:INFO: [Epoch. 8.]: 100%|| 8/8 [00:00<00:00, 16.78it/s, avg_loss=0.298]
02/23/2023 13:24:18:INFO: Epoch 8, average loss: 0.2984365038573742
02/23/2023 13:24:18:INFO: --------------Evaluate on Epoch. 8.---------------
02/23/2023 13:24:18:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:24:18:INFO: **********Results Comparison**********
02/23/2023 13:24:18:INFO: 真实标签: 
 [1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 1, 1, 3, 1, 1, 3, 2, 1, 1, 1, 3, 1, 3, 3, 3, 1, 2, 3, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 2, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 2, 2, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1]
02/23/2023 13:24:18:INFO: 预测标签: 
 [1, 3, 3, 2, 1, 3, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 1, 2, 2, 3, 3, 3, 3, 3, 2, 2, 2, 1, 2, 3, 3, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 3, 2, 2, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 3, 2, 1, 2, 2, 1, 2, 2, 2, 2, 3, 2, 2, 2, 1, 3, 1, 1, 1, 2, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 1, 2]
02/23/2023 13:24:18:INFO: ---------Evaluated Metrics----------
02/23/2023 13:24:18:INFO: Accuracy: 0.2627118644067797.
02/23/2023 13:24:18:INFO: Macro Precision: 0.47975455614344503.
02/23/2023 13:24:18:INFO: Macro Recall: 0.36132890365448506.
02/23/2023 13:24:18:INFO: Macro F1 score: 0.26873476041472394.
02/23/2023 13:24:18:INFO: ---------confusion_matrix----------
02/23/2023 13:24:18:INFO: 
[[20 59  7]
 [ 1  4  2]
 [ 0 18  7]]
02/23/2023 13:24:18:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:24:18:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:24:18:INFO: --------------Epoch. 9.---------------
02/23/2023 13:24:19:INFO: [Epoch. 9.]: 100%|| 8/8 [00:00<00:00, 16.62it/s, avg_loss=0.28]
02/23/2023 13:24:19:INFO: Epoch 9, average loss: 0.2802711669355631
02/23/2023 13:24:19:INFO: --------------Evaluate on Epoch. 9.---------------
02/23/2023 13:24:19:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:24:19:INFO: **********Results Comparison**********
02/23/2023 13:24:19:INFO: 真实标签: 
 [1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 1, 1, 3, 1, 1, 3, 2, 1, 1, 1, 3, 1, 3, 3, 3, 1, 2, 3, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 2, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 2, 2, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1]
02/23/2023 13:24:19:INFO: 预测标签: 
 [1, 3, 3, 2, 1, 3, 2, 2, 2, 2, 2, 2, 1, 3, 2, 2, 2, 1, 2, 2, 3, 1, 3, 3, 3, 2, 2, 2, 1, 2, 3, 3, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 2, 2, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 2, 2, 1, 2, 2, 2, 2, 3, 2, 3, 2, 2, 2, 3, 2, 1, 2, 1, 1, 1, 2, 2, 2, 3, 2, 2, 2, 1, 3, 1, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 1, 2, 2, 1, 1]
02/23/2023 13:24:19:INFO: ---------Evaluated Metrics----------
02/23/2023 13:24:19:INFO: Accuracy: 0.3474576271186441.
02/23/2023 13:24:19:INFO: Macro Precision: 0.49665471923536436.
02/23/2023 13:24:19:INFO: Macro Recall: 0.40008859357696563.
02/23/2023 13:24:19:INFO: Macro F1 score: 0.32136211186844105.
02/23/2023 13:24:19:INFO: ---------confusion_matrix----------
02/23/2023 13:24:19:INFO: 
[[30 50  6]
 [ 1  4  2]
 [ 0 18  7]]
02/23/2023 13:24:19:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:24:19:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:24:19:INFO: Based on [4.th Epoch] best_accuracy: 0.6186440677966102.
02/23/2023 13:24:19:INFO: latest 5 epochs not seen performance increased, early stop.
02/23/2023 13:24:19:INFO: ********** Best Results on Dev Dataset **********
02/23/2023 13:24:19:INFO: Best Accuracy: 0.6186440677966102.
02/23/2023 13:24:19:INFO: Best Macro Precision: 0.5037037037037037.
02/23/2023 13:24:19:INFO: Best Macro Recall: 0.5276633444075304.
02/23/2023 13:24:19:INFO: Best Macro F1 score: 0.4805998207532734.
02/23/2023 13:24:19:INFO: ***** Training Over *****
02/23/2023 13:24:19:INFO: --------------Testing ...---------------
02/23/2023 13:24:19:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:24:21:INFO: **********Results Comparison**********
02/23/2023 13:24:21:INFO: 真实标签: 
 [1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 3, 3, 1, 1, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 3, 1, 3, 3, 1, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 2, 1, 2, 2, 3, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 2, 1, 1, 1, 1, 1, 1, 1, 3, 3, 3, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 3, 3, 3, 1, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 3, 2, 3, 2, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 1, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 2, 1, 1, 1, 2, 3, 1, 1, 1, 1, 1, 1, 3, 3, 1, 2, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 2, 1, 3, 3, 1, 1, 1, 1, 1, 2, 1, 3, 3, 1, 1, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
02/23/2023 13:24:21:INFO: 预测标签: 
 [1, 3, 2, 3, 1, 2, 3, 2, 2, 2, 2, 1, 3, 2, 2, 2, 3, 2, 2, 1, 2, 1, 1, 2, 2, 1, 3, 2, 2, 2, 1, 2, 1, 2, 2, 2, 2, 1, 1, 1, 1, 2, 2, 3, 1, 2, 3, 2, 2, 1, 2, 3, 2, 2, 1, 2, 2, 1, 2, 1, 2, 1, 1, 2, 2, 2, 2, 1, 3, 1, 1, 2, 2, 1, 2, 2, 3, 2, 2, 3, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 3, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 1, 1, 2, 2, 2, 2, 1, 2, 2, 2, 3, 2, 3, 3, 2, 1, 2, 3, 1, 1, 1, 1, 2, 2, 1, 3, 2, 3, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 1, 2, 3, 2, 2, 1, 2, 3, 3, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 2, 2, 1, 2, 2, 2, 3, 2, 3, 2, 2, 2, 2, 2, 1, 3, 2, 2, 2, 1, 2, 1, 1, 1, 3, 1, 1, 1, 3, 2, 1, 2, 1, 2, 2, 2, 2, 2, 3, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 2, 2, 3, 3, 1, 2, 2, 2, 3, 2, 3, 1, 2, 1, 2, 2, 1, 1, 1, 1, 2, 1, 1, 2, 2, 2, 3, 1, 3, 3, 3, 1, 2, 1, 2, 2, 2, 1, 2, 2, 3, 2, 1, 2, 3, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 1, 1, 2, 2, 1, 1, 2, 2, 2, 2, 2, 3, 1, 2, 2, 2, 2, 2, 2, 1, 2, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1, 1, 2, 1, 3, 1, 2, 2, 2, 2, 2, 2, 3, 3, 2, 2, 3, 3, 2, 1, 1, 2, 2, 2, 2, 1, 2, 1, 2, 2, 2, 3, 3, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 2, 2, 2, 1, 2, 2, 1, 3, 3, 3, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1, 2, 1, 1, 2, 2, 2, 2]
02/23/2023 13:24:21:INFO: ---------Evaluated Metrics----------
02/23/2023 13:24:21:INFO: Accuracy: 0.30861244019138756.
02/23/2023 13:24:21:INFO: Macro Precision: 0.43258486305361304.
02/23/2023 13:24:21:INFO: Macro Recall: 0.38924086757990867.
02/23/2023 13:24:21:INFO: Macro F1 score: 0.2879902893872935.
02/23/2023 13:24:21:INFO: ---------confusion_matrix----------
02/23/2023 13:24:21:INFO: 
[[ 94 200  26]
 [  4  15   6]
 [ 12  41  20]]
02/23/2023 13:24:21:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:24:21:INFO: ----------------------Testing finished.------------------------
02/23/2023 13:24:21:INFO: bengio.
