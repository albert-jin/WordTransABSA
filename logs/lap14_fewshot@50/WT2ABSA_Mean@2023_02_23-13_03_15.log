02/23/2023 13:03:15:INFO: start.
02/23/2023 13:03:15:INFO: --------hyper-arguments for this training.--------
02/23/2023 13:03:15:INFO: Namespace(answer_strategy='inter_logits_core_token', batch_size=2, dataset='lap14', eval_pre_epochs=1, few_shot=50, learning_rate=1e-05, log_file=None, model_type='WT2ABSA_Mean', patience=5, pre_trained_model='pretrainedmodels/bert-base-cased', save_best_model=False, seed=985, total_epochs=20)
02/23/2023 13:03:15:INFO: ----------dataset files------------
02/23/2023 13:03:15:INFO: {'train': '../WordTrans2ABSA/dataset/lap14/train.json', 'dev': '../WordTrans2ABSA/dataset/lap14/dev.json', 'test': '../WordTrans2ABSA/dataset/lap14/test.json'}
02/23/2023 13:03:21:WARNING: Using custom data configuration default-36681205633e2245
02/23/2023 13:03:21:WARNING: Reusing dataset json (C:\Users\Super-IdoI\.cache\huggingface\datasets\json\default-36681205633e2245\0.0.0\45636811569ec4a6630521c18235dfbbab83b7ab572e3393c5ba68ccabe98264)
02/23/2023 13:03:21:INFO: -----------------------------------
02/23/2023 13:03:21:INFO: {'I-POS': ['good', 'clever', 'excellent', 'effectual', 'beautiful', 'nice', 'useful', 'well', 'fantastic'], 'I-NEU': ['Michael', 'John', 'David', 'Thomas', 'Martin', 'Paul'], 'I-NEG': ['bad', 'terrible', 'awful', 'badly', 'terrible', 'poor', 'unfortunate', 'harmful', 'dirty', 'sorry']}
02/23/2023 13:03:21:INFO: -----------------------------------
02/23/2023 13:03:21:INFO: {'O': 0, 'I-POS': 1, 'I-NEU': 2, 'I-NEG': 3}
02/23/2023 13:03:21:INFO: {0: 'O', 1: 'I-POS', 2: 'I-NEU', 3: 'I-NEG'}
02/23/2023 13:03:23:INFO: -----------------------------------
02/23/2023 13:03:23:INFO: {'I-POS': 28996, 'I-NEU': 28997, 'I-NEG': 28998}
02/23/2023 13:03:23:INFO: {28996: 'I-POS', 28997: 'I-NEU', 28998: 'I-NEG'}
02/23/2023 13:03:23:INFO: start preprocess dataset.
02/23/2023 13:03:23:INFO: dataset preprocess finished.
02/23/2023 13:03:23:INFO: Train: 150, Dev: 150, Test: 409.
02/23/2023 13:03:23:INFO: dataloader prepare finished.
02/23/2023 13:03:23:INFO: ***** Start Training *****
02/23/2023 13:03:23:INFO: Total Epochs: 20
02/23/2023 13:03:23:INFO: validate on per-1 epochs.
02/23/2023 13:03:23:INFO: Training Samples Count: 150.
02/23/2023 13:03:23:INFO: Batch Size: 2, 每轮 75 Batch.
02/23/2023 13:03:23:INFO: Learning Rate: 1e-05
02/23/2023 13:03:23:INFO: --------------Epoch. 1.---------------
02/23/2023 13:03:28:INFO: [Epoch. 1.]: 100%|| 75/75 [00:04<00:00, 15.17it/s, avg_loss=1.3]
02/23/2023 13:03:28:INFO: Epoch 1, average loss: 1.297877333164215
02/23/2023 13:03:28:INFO: --------------Evaluate on Epoch. 1.---------------
02/23/2023 13:03:28:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:03:29:INFO: **********Results Comparison**********
02/23/2023 13:03:29:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:03:29:INFO: 预测标签: 
 [2, 2, 3, 3, 2, 1, 2, 2, 3, 1, 2, 1, 1, 2, 2, 3, 2, 2, 2, 2, 2, 2, 3, 3, 2, 1, 2, 3, 2, 2, 1, 2, 2, 2, 1, 2, 3, 2, 1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 1, 2, 2, 2, 3, 2, 3, 1, 2, 3, 2, 2, 3, 3, 2, 1, 2, 1, 1, 3, 2, 3, 2, 2, 3, 2, 2, 2, 2, 3, 1, 2, 2, 1, 3, 1, 2, 2, 1, 2, 1, 1, 3, 2, 2, 3, 2, 1, 1, 2, 2, 1, 2, 2, 2, 2, 3, 2, 2, 2, 2, 3, 2, 2, 1, 1, 1, 3, 2, 2, 1, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 1, 2, 3, 1, 2, 3, 2, 1, 2, 2, 2, 1, 2, 2, 3]
02/23/2023 13:03:29:INFO: ---------Evaluated Metrics----------
02/23/2023 13:03:29:INFO: Accuracy: 0.4066666666666667.
02/23/2023 13:03:29:INFO: Macro Precision: 0.5331693226604.
02/23/2023 13:03:29:INFO: Macro Recall: 0.45715217018356497.
02/23/2023 13:03:29:INFO: Macro F1 score: 0.4084814054160834.
02/23/2023 13:03:29:INFO: ---------confusion_matrix----------
02/23/2023 13:03:29:INFO: 
[[29 32  6]
 [ 2 17  6]
 [ 3 40 15]]
02/23/2023 13:03:29:INFO: 模型效果验证详情: {'位置第一个显示标签': 0, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:03:29:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:03:29:INFO: --------------Epoch. 2.---------------
02/23/2023 13:03:34:INFO: [Epoch. 2.]: 100%|| 75/75 [00:04<00:00, 15.86it/s, avg_loss=0.586]
02/23/2023 13:03:34:INFO: Epoch 2, average loss: 0.5859158901373546
02/23/2023 13:03:34:INFO: --------------Evaluate on Epoch. 2.---------------
02/23/2023 13:03:34:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:03:34:INFO: **********Results Comparison**********
02/23/2023 13:03:34:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:03:34:INFO: 预测标签: 
 [2, 2, 3, 2, 2, 1, 2, 2, 3, 1, 3, 1, 1, 2, 2, 3, 2, 3, 3, 2, 2, 2, 2, 3, 3, 1, 2, 3, 1, 2, 1, 2, 2, 2, 1, 2, 3, 2, 1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 1, 2, 2, 2, 2, 2, 3, 1, 1, 3, 2, 2, 3, 3, 2, 1, 3, 1, 1, 3, 2, 3, 2, 2, 3, 3, 2, 2, 2, 3, 1, 2, 2, 1, 3, 1, 1, 2, 1, 2, 1, 1, 3, 2, 1, 3, 2, 1, 3, 2, 2, 1, 2, 2, 2, 2, 3, 2, 2, 2, 3, 3, 2, 2, 1, 1, 1, 3, 3, 2, 1, 2, 3, 2, 3, 2, 2, 2, 2, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1, 3, 1, 2, 3, 3, 3, 2, 2, 2, 1, 2, 2, 3]
02/23/2023 13:03:34:INFO: ---------Evaluated Metrics----------
02/23/2023 13:03:34:INFO: Accuracy: 0.54.
02/23/2023 13:03:34:INFO: Macro Precision: 0.6403508771929824.
02/23/2023 13:03:34:INFO: Macro Recall: 0.5826351003602676.
02/23/2023 13:03:34:INFO: Macro F1 score: 0.5391241251784753.
02/23/2023 13:03:34:INFO: ---------confusion_matrix----------
02/23/2023 13:03:34:INFO: 
[[35 27  5]
 [ 2 19  4]
 [ 1 30 27]]
02/23/2023 13:03:34:INFO: 模型效果验证详情: {'位置第一个显示标签': 1, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:03:34:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:03:34:INFO: --------------Epoch. 3.---------------
02/23/2023 13:03:39:INFO: [Epoch. 3.]: 100%|| 75/75 [00:04<00:00, 16.07it/s, avg_loss=0.292]
02/23/2023 13:03:39:INFO: Epoch 3, average loss: 0.29244095434745154
02/23/2023 13:03:39:INFO: --------------Evaluate on Epoch. 3.---------------
02/23/2023 13:03:39:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:03:40:INFO: **********Results Comparison**********
02/23/2023 13:03:40:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:03:40:INFO: 预测标签: 
 [2, 2, 3, 2, 2, 1, 2, 2, 3, 1, 3, 3, 1, 2, 2, 3, 2, 3, 3, 2, 2, 2, 2, 3, 3, 1, 2, 3, 1, 2, 1, 2, 2, 2, 1, 2, 2, 2, 1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 3, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 3, 3, 2, 3, 3, 1, 1, 3, 2, 3, 2, 2, 3, 3, 2, 2, 2, 3, 1, 2, 2, 1, 3, 1, 1, 2, 1, 2, 1, 1, 3, 2, 1, 3, 2, 1, 3, 2, 2, 1, 2, 2, 2, 2, 3, 2, 2, 2, 3, 2, 2, 2, 1, 3, 1, 3, 3, 2, 1, 2, 3, 2, 3, 2, 3, 2, 2, 2, 2, 1, 2, 2, 3, 1, 2, 1, 1, 3, 1, 2, 3, 3, 3, 2, 2, 2, 1, 2, 2, 3]
02/23/2023 13:03:40:INFO: ---------Evaluated Metrics----------
02/23/2023 13:03:40:INFO: Accuracy: 0.52.
02/23/2023 13:03:40:INFO: Macro Precision: 0.645230217810863.
02/23/2023 13:03:40:INFO: Macro Recall: 0.5768399382398354.
02/23/2023 13:03:40:INFO: Macro F1 score: 0.5235056221801435.
02/23/2023 13:03:40:INFO: ---------confusion_matrix----------
02/23/2023 13:03:40:INFO: 
[[30 30  7]
 [ 1 20  4]
 [ 0 30 28]]
02/23/2023 13:03:40:INFO: 模型效果验证详情: {'位置第一个显示标签': 38, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:03:40:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:03:40:INFO: --------------Epoch. 4.---------------
02/23/2023 13:03:44:INFO: [Epoch. 4.]: 100%|| 75/75 [00:04<00:00, 16.23it/s, avg_loss=0.158]
02/23/2023 13:03:44:INFO: Epoch 4, average loss: 0.15828840672969818
02/23/2023 13:03:44:INFO: --------------Evaluate on Epoch. 4.---------------
02/23/2023 13:03:44:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:03:45:INFO: **********Results Comparison**********
02/23/2023 13:03:45:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:03:45:INFO: 预测标签: 
 [3, 1, 1, 2, 2, 1, 2, 1, 3, 1, 3, 1, 1, 1, 1, 1, 2, 3, 3, 3, 2, 2, 2, 3, 3, 1, 2, 3, 1, 1, 1, 3, 1, 1, 1, 2, 2, 1, 1, 1, 2, 2, 3, 1, 1, 1, 1, 2, 1, 1, 3, 2, 2, 2, 3, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 1, 3, 3, 2, 2, 1, 3, 1, 1, 2, 1, 3, 1, 1, 2, 1, 2, 1, 1, 3, 3, 1, 3, 3, 1, 3, 2, 1, 1, 1, 2, 2, 3, 3, 3, 2, 2, 3, 3, 1, 2, 1, 1, 1, 3, 3, 1, 1, 3, 3, 1, 3, 3, 3, 1, 3, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 3, 1, 1, 3, 3, 3, 2, 3, 2, 1, 2, 2, 3]
02/23/2023 13:03:45:INFO: ---------Evaluated Metrics----------
02/23/2023 13:03:45:INFO: Accuracy: 0.6333333333333333.
02/23/2023 13:03:45:INFO: Macro Precision: 0.5659758681035276.
02/23/2023 13:03:45:INFO: Macro Recall: 0.5498061417052668.
02/23/2023 13:03:45:INFO: Macro F1 score: 0.5539614620913387.
02/23/2023 13:03:45:INFO: ---------confusion_matrix----------
02/23/2023 13:03:45:INFO: 
[[54 11  2]
 [ 9  6 10]
 [ 7 16 35]]
02/23/2023 13:03:45:INFO: 模型效果验证详情: {'位置第一个显示标签': 48, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:03:45:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:03:45:INFO: --------------Epoch. 5.---------------
02/23/2023 13:03:50:INFO: [Epoch. 5.]: 100%|| 75/75 [00:04<00:00, 16.21it/s, avg_loss=0.0908]
02/23/2023 13:03:50:INFO: Epoch 5, average loss: 0.09081644972165426
02/23/2023 13:03:50:INFO: --------------Evaluate on Epoch. 5.---------------
02/23/2023 13:03:50:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:03:50:INFO: **********Results Comparison**********
02/23/2023 13:03:50:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:03:50:INFO: 预测标签: 
 [2, 1, 3, 2, 2, 1, 2, 2, 3, 1, 3, 3, 2, 2, 1, 3, 2, 3, 3, 3, 2, 2, 2, 3, 3, 1, 2, 3, 1, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 3, 2, 1, 2, 2, 1, 3, 3, 2, 3, 3, 3, 1, 3, 2, 3, 3, 1, 3, 3, 2, 2, 1, 3, 1, 2, 2, 1, 3, 1, 1, 2, 1, 2, 1, 1, 3, 3, 1, 3, 3, 1, 3, 2, 1, 1, 1, 2, 2, 2, 3, 2, 2, 2, 3, 2, 2, 2, 1, 3, 1, 3, 3, 2, 1, 2, 3, 2, 2, 2, 3, 1, 2, 2, 2, 1, 2, 1, 1, 1, 2, 1, 1, 3, 1, 2, 3, 3, 3, 2, 3, 2, 1, 2, 2, 3]
02/23/2023 13:03:50:INFO: ---------Evaluated Metrics----------
02/23/2023 13:03:50:INFO: Accuracy: 0.54.
02/23/2023 13:03:50:INFO: Macro Precision: 0.6013767854380446.
02/23/2023 13:03:50:INFO: Macro Recall: 0.5507462686567165.
02/23/2023 13:03:50:INFO: Macro F1 score: 0.5297043135326964.
02/23/2023 13:03:50:INFO: ---------confusion_matrix----------
02/23/2023 13:03:50:INFO: 
[[37 23  7]
 [ 3 15  7]
 [ 1 28 29]]
02/23/2023 13:03:50:INFO: 模型效果验证详情: {'位置第一个显示标签': 55, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:03:50:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:03:50:INFO: --------------Epoch. 6.---------------
02/23/2023 13:03:55:INFO: [Epoch. 6.]: 100%|| 75/75 [00:04<00:00, 16.44it/s, avg_loss=0.0533]
02/23/2023 13:03:55:INFO: Epoch 6, average loss: 0.05328953384111325
02/23/2023 13:03:55:INFO: --------------Evaluate on Epoch. 6.---------------
02/23/2023 13:03:55:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:03:56:INFO: **********Results Comparison**********
02/23/2023 13:03:56:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:03:56:INFO: 预测标签: 
 [3, 1, 1, 2, 2, 1, 2, 2, 3, 1, 3, 1, 1, 2, 1, 3, 2, 3, 3, 3, 2, 2, 2, 3, 3, 1, 2, 3, 1, 1, 1, 2, 1, 1, 1, 2, 2, 2, 1, 1, 2, 2, 2, 2, 1, 2, 1, 2, 1, 2, 2, 2, 2, 2, 3, 1, 1, 1, 2, 1, 3, 3, 2, 3, 3, 3, 1, 3, 2, 1, 3, 1, 3, 3, 2, 2, 1, 3, 1, 2, 2, 1, 3, 1, 1, 2, 1, 2, 1, 1, 3, 3, 1, 3, 3, 1, 3, 2, 1, 1, 1, 2, 2, 2, 3, 3, 2, 2, 3, 2, 1, 2, 1, 1, 1, 3, 3, 2, 1, 3, 3, 2, 2, 2, 2, 1, 3, 2, 1, 1, 2, 1, 1, 1, 2, 1, 1, 3, 1, 2, 3, 3, 3, 2, 3, 2, 1, 2, 2, 3]
02/23/2023 13:03:56:INFO: ---------Evaluated Metrics----------
02/23/2023 13:03:56:INFO: Accuracy: 0.5733333333333334.
02/23/2023 13:03:56:INFO: Macro Precision: 0.5883468834688347.
02/23/2023 13:03:56:INFO: Macro Recall: 0.5429610567850404.
02/23/2023 13:03:56:INFO: Macro F1 score: 0.5416207529843894.
02/23/2023 13:03:56:INFO: ---------confusion_matrix----------
02/23/2023 13:03:56:INFO: 
[[45 18  4]
 [ 7 11  7]
 [ 2 26 30]]
02/23/2023 13:03:56:INFO: 模型效果验证详情: {'位置第一个显示标签': 56, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:03:56:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:03:56:INFO: --------------Epoch. 7.---------------
02/23/2023 13:04:00:INFO: [Epoch. 7.]: 100%|| 75/75 [00:04<00:00, 16.27it/s, avg_loss=0.0431]
02/23/2023 13:04:00:INFO: Epoch 7, average loss: 0.043065499278406305
02/23/2023 13:04:00:INFO: --------------Evaluate on Epoch. 7.---------------
02/23/2023 13:04:00:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:04:01:INFO: **********Results Comparison**********
02/23/2023 13:04:01:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:04:01:INFO: 预测标签: 
 [3, 1, 1, 2, 2, 1, 2, 2, 3, 1, 3, 2, 1, 2, 1, 3, 2, 3, 3, 3, 2, 2, 2, 3, 3, 1, 2, 3, 1, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 1, 2, 2, 2, 2, 1, 2, 1, 2, 3, 2, 2, 2, 2, 2, 3, 2, 1, 3, 2, 1, 3, 3, 2, 3, 3, 3, 1, 3, 2, 3, 3, 1, 3, 3, 2, 2, 1, 3, 1, 2, 2, 1, 3, 1, 1, 2, 1, 2, 1, 1, 3, 3, 1, 3, 2, 1, 3, 2, 1, 1, 1, 2, 2, 2, 3, 3, 2, 2, 3, 2, 2, 2, 1, 3, 1, 3, 3, 2, 1, 2, 3, 2, 3, 2, 2, 1, 3, 2, 2, 1, 2, 1, 1, 1, 2, 1, 1, 3, 1, 2, 3, 3, 3, 2, 3, 2, 1, 2, 2, 3]
02/23/2023 13:04:01:INFO: ---------Evaluated Metrics----------
02/23/2023 13:04:01:INFO: Accuracy: 0.5533333333333333.
02/23/2023 13:04:01:INFO: Macro Precision: 0.594775625103494.
02/23/2023 13:04:01:INFO: Macro Recall: 0.5455241036198318.
02/23/2023 13:04:01:INFO: Macro F1 score: 0.535532430026274.
02/23/2023 13:04:01:INFO: ---------confusion_matrix----------
02/23/2023 13:04:01:INFO: 
[[39 22  6]
 [ 5 13  7]
 [ 1 26 31]]
02/23/2023 13:04:01:INFO: 模型效果验证详情: {'位置第一个显示标签': 59, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:04:01:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:04:01:INFO: --------------Epoch. 8.---------------
02/23/2023 13:04:06:INFO: [Epoch. 8.]: 100%|| 75/75 [00:04<00:00, 16.41it/s, avg_loss=0.0274]
02/23/2023 13:04:06:INFO: Epoch 8, average loss: 0.027407499930510917
02/23/2023 13:04:06:INFO: --------------Evaluate on Epoch. 8.---------------
02/23/2023 13:04:06:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:04:06:INFO: **********Results Comparison**********
02/23/2023 13:04:06:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:04:06:INFO: 预测标签: 
 [3, 1, 1, 2, 2, 1, 2, 2, 3, 1, 3, 2, 1, 2, 1, 3, 2, 3, 3, 3, 2, 2, 2, 3, 3, 1, 2, 3, 1, 1, 1, 3, 1, 1, 1, 2, 2, 2, 1, 1, 2, 3, 3, 2, 1, 1, 1, 2, 3, 2, 2, 2, 2, 2, 3, 1, 1, 3, 2, 1, 3, 3, 2, 3, 3, 3, 1, 3, 2, 1, 3, 1, 3, 3, 2, 2, 1, 3, 1, 2, 2, 1, 3, 1, 1, 2, 1, 2, 1, 1, 3, 3, 1, 3, 3, 1, 3, 2, 1, 1, 1, 2, 2, 2, 3, 3, 2, 2, 3, 2, 1, 2, 1, 1, 1, 3, 3, 2, 1, 2, 3, 2, 3, 2, 3, 1, 3, 2, 1, 1, 2, 1, 1, 1, 2, 1, 1, 3, 1, 1, 3, 3, 3, 2, 3, 2, 1, 2, 2, 3]
02/23/2023 13:04:06:INFO: ---------Evaluated Metrics----------
02/23/2023 13:04:06:INFO: Accuracy: 0.5866666666666667.
02/23/2023 13:04:06:INFO: Macro Precision: 0.5853338685936036.
02/23/2023 13:04:06:INFO: Macro Recall: 0.5484131068793962.
02/23/2023 13:04:06:INFO: Macro F1 score: 0.5499999999999999.
02/23/2023 13:04:06:INFO: ---------confusion_matrix----------
02/23/2023 13:04:06:INFO: 
[[43 19  5]
 [ 8 10  7]
 [ 2 21 35]]
02/23/2023 13:04:06:INFO: 模型效果验证详情: {'位置第一个显示标签': 59, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:04:06:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:04:06:INFO: --------------Epoch. 9.---------------
02/23/2023 13:04:11:INFO: [Epoch. 9.]: 100%|| 75/75 [00:04<00:00, 16.32it/s, avg_loss=0.0191]
02/23/2023 13:04:11:INFO: Epoch 9, average loss: 0.019080634073664744
02/23/2023 13:04:11:INFO: --------------Evaluate on Epoch. 9.---------------
02/23/2023 13:04:11:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:04:12:INFO: **********Results Comparison**********
02/23/2023 13:04:12:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:04:12:INFO: 预测标签: 
 [3, 1, 1, 2, 2, 1, 2, 2, 3, 1, 3, 2, 1, 2, 1, 3, 2, 3, 3, 3, 2, 2, 2, 3, 3, 1, 2, 3, 1, 1, 1, 3, 1, 1, 1, 2, 2, 2, 1, 1, 2, 3, 3, 2, 1, 1, 1, 2, 3, 2, 2, 2, 2, 2, 3, 1, 1, 3, 2, 1, 3, 3, 2, 3, 3, 3, 1, 3, 2, 3, 3, 1, 3, 3, 2, 2, 1, 3, 1, 2, 2, 1, 3, 1, 1, 2, 1, 2, 1, 1, 3, 3, 1, 3, 3, 1, 3, 2, 1, 1, 1, 2, 2, 2, 3, 3, 2, 2, 3, 2, 1, 2, 1, 3, 1, 3, 3, 2, 1, 3, 3, 2, 3, 2, 3, 1, 3, 2, 1, 1, 2, 1, 1, 1, 2, 1, 1, 3, 1, 1, 3, 3, 3, 2, 3, 2, 1, 2, 2, 3]
02/23/2023 13:04:12:INFO: ---------Evaluated Metrics----------
02/23/2023 13:04:12:INFO: Accuracy: 0.5866666666666667.
02/23/2023 13:04:12:INFO: Macro Precision: 0.5825370148059223.
02/23/2023 13:04:12:INFO: Macro Recall: 0.5491851089380683.
02/23/2023 13:04:12:INFO: Macro F1 score: 0.5496004479055326.
02/23/2023 13:04:12:INFO: ---------confusion_matrix----------
02/23/2023 13:04:12:INFO: 
[[42 19  6]
 [ 7 10  8]
 [ 2 20 36]]
02/23/2023 13:04:12:INFO: 模型效果验证详情: {'位置第一个显示标签': 66, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:04:12:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:04:12:INFO: --------------Epoch. 10.---------------
02/23/2023 13:04:16:INFO: [Epoch. 10.]: 100%|| 75/75 [00:04<00:00, 16.30it/s, avg_loss=0.0161]
02/23/2023 13:04:16:INFO: Epoch 10, average loss: 0.016079932457456987
02/23/2023 13:04:16:INFO: --------------Evaluate on Epoch. 10.---------------
02/23/2023 13:04:16:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:04:17:INFO: **********Results Comparison**********
02/23/2023 13:04:17:INFO: 真实标签: 
 [2, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 1, 1, 3, 3, 3, 3, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 3, 1, 2, 1, 2, 1, 1, 1, 3, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 3, 2, 3, 3, 2, 3, 1, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 3, 1, 1, 2, 3, 3, 2, 3, 3, 1, 3, 3, 2, 2, 2, 1, 2, 1, 3, 3, 1, 1, 3, 2, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 3, 3, 3, 2, 1, 1, 3, 2, 1]
02/23/2023 13:04:17:INFO: 预测标签: 
 [3, 1, 1, 2, 2, 1, 2, 2, 3, 1, 3, 1, 1, 2, 1, 3, 2, 3, 3, 3, 2, 2, 2, 3, 3, 1, 2, 3, 1, 1, 1, 3, 1, 1, 1, 2, 2, 2, 1, 1, 2, 3, 3, 1, 1, 1, 1, 2, 1, 2, 2, 2, 2, 2, 3, 1, 1, 1, 2, 1, 3, 3, 2, 3, 3, 3, 1, 3, 2, 1, 3, 1, 3, 3, 2, 2, 1, 3, 1, 2, 2, 1, 3, 1, 1, 2, 1, 2, 1, 1, 3, 3, 1, 3, 3, 1, 3, 2, 1, 1, 1, 2, 2, 2, 3, 3, 2, 2, 3, 2, 1, 2, 1, 1, 1, 3, 3, 2, 1, 3, 3, 1, 3, 2, 3, 1, 3, 3, 1, 1, 3, 1, 1, 1, 2, 1, 1, 3, 1, 1, 3, 3, 3, 2, 3, 2, 1, 2, 2, 3]
02/23/2023 13:04:17:INFO: ---------Evaluated Metrics----------
02/23/2023 13:04:17:INFO: Accuracy: 0.62.
02/23/2023 13:04:17:INFO: Macro Precision: 0.5970698362939743.
02/23/2023 13:04:17:INFO: Macro Recall: 0.5748327328872878.
02/23/2023 13:04:17:INFO: Macro F1 score: 0.5746560933369794.
02/23/2023 13:04:17:INFO: ---------confusion_matrix----------
02/23/2023 13:04:17:INFO: 
[[46 17  4]
 [ 8 10  7]
 [ 4 17 37]]
02/23/2023 13:04:17:INFO: 模型效果验证详情: {'位置第一个显示标签': 64, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:04:17:INFO: ----------------------Evaluate finished.------------------------
02/23/2023 13:04:17:INFO: Based on [5.th Epoch] best_accuracy: 0.6333333333333333.
02/23/2023 13:04:17:INFO: latest 5 epochs not seen performance increased, early stop.
02/23/2023 13:04:17:INFO: ********** Best Results on Dev Dataset **********
02/23/2023 13:04:17:INFO: Best Accuracy: 0.6333333333333333.
02/23/2023 13:04:17:INFO: Best Macro Precision: 0.5970698362939743.
02/23/2023 13:04:17:INFO: Best Macro Recall: 0.5748327328872878.
02/23/2023 13:04:17:INFO: Best Macro F1 score: 0.5746560933369794.
02/23/2023 13:04:17:INFO: ***** Training Over *****
02/23/2023 13:04:17:INFO: --------------Testing ...---------------
02/23/2023 13:04:17:INFO: tensor([28996, 28997, 28998], device='cuda:0')
02/23/2023 13:04:19:INFO: **********Results Comparison**********
02/23/2023 13:04:19:INFO: 真实标签: 
 [1, 3, 1, 3, 1, 2, 1, 1, 1, 1, 3, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 3, 1, 3, 3, 1, 1, 1, 1, 1, 1, 3, 1, 3, 1, 1, 1, 3, 1, 1, 1, 3, 1, 1, 1, 1, 3, 2, 1, 1, 1, 3, 2, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 2, 1, 1, 1, 3, 1, 3, 2, 3, 1, 1, 1, 1, 1, 3, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 3, 1, 2, 3, 3, 1, 3, 1, 1, 3, 3, 1, 1, 1, 2, 2, 3, 2, 3, 2, 2, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 3, 2, 1, 1, 1, 2, 3, 2, 3, 3, 3, 3, 3, 3, 1, 2, 2, 1, 1, 1, 1, 1, 1, 2, 3, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 2, 1, 2, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 3, 1, 1, 1, 1, 2, 2, 3, 1, 1, 1, 1, 1, 3, 2, 2, 1, 1, 1, 1, 1, 1, 3, 2, 3, 1, 1, 2, 2, 1, 2, 2, 1, 3, 2, 1, 1, 1, 3, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 2, 2, 1, 3, 1, 3, 1, 1, 1, 3, 2, 1, 2, 2, 1, 2, 1, 1, 1, 1, 2, 3, 2, 2, 1, 3, 1, 2, 1, 2, 1, 3, 3, 1, 1, 1, 1, 3, 1, 3, 1, 1, 1, 2, 1, 1, 2, 2, 3, 3, 2, 1, 1, 2, 3, 1, 1, 2, 3, 2, 2, 2, 2, 2, 3, 2, 3, 1, 1, 1, 3, 1, 3, 2, 1, 1, 1, 1, 1, 2, 1, 3, 3, 1, 1, 1, 2, 2, 2, 2, 2, 3, 1, 1, 1, 1, 2, 2, 1, 2, 2, 2, 2, 2, 3, 2, 1, 3, 1, 2, 1, 2, 1, 3, 2, 1, 1, 1, 2, 2, 1, 1, 1, 1, 2, 3, 2, 2, 1, 1, 1, 1, 2, 2, 3, 1, 1, 3, 2, 3, 2, 2, 2, 1, 1, 2, 1, 1, 3, 1, 2, 2, 1, 2, 3, 1, 1, 3, 1, 2, 2, 1]
02/23/2023 13:04:19:INFO: 预测标签: 
 [2, 3, 2, 2, 1, 2, 1, 1, 1, 1, 2, 3, 1, 1, 3, 1, 3, 1, 1, 1, 1, 3, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 1, 1, 2, 1, 3, 1, 1, 2, 3, 1, 2, 1, 2, 1, 1, 2, 1, 3, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 1, 1, 3, 2, 1, 1, 3, 1, 1, 1, 1, 1, 3, 1, 1, 1, 3, 2, 1, 1, 1, 2, 2, 3, 1, 3, 2, 3, 1, 3, 1, 1, 3, 3, 1, 1, 2, 2, 2, 1, 1, 1, 2, 3, 1, 1, 1, 1, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 2, 1, 1, 2, 2, 3, 3, 3, 2, 1, 3, 1, 1, 1, 2, 1, 1, 1, 2, 3, 1, 1, 1, 2, 1, 1, 3, 2, 2, 1, 1, 1, 2, 2, 2, 2, 1, 1, 1, 2, 2, 1, 1, 2, 1, 1, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 2, 1, 1, 3, 2, 3, 1, 1, 3, 2, 2, 3, 1, 2, 3, 1, 3, 3, 1, 2, 2, 1, 1, 1, 1, 3, 2, 2, 1, 1, 3, 2, 1, 2, 3, 1, 2, 1, 1, 1, 1, 3, 1, 1, 3, 1, 1, 3, 1, 2, 2, 1, 1, 2, 3, 2, 2, 2, 2, 3, 2, 3, 1, 2, 2, 2, 2, 1, 1, 1, 2, 3, 2, 1, 2, 1, 2, 3, 2, 2, 1, 3, 1, 2, 1, 1, 2, 2, 3, 2, 3, 2, 2, 2, 2, 2, 2, 1, 1, 2, 1, 3, 2, 2, 2, 2, 2, 1, 2, 2, 3, 1, 1, 2, 2, 2, 1, 2, 3, 2, 1, 2, 2, 1, 1, 3, 2, 1, 2, 3, 1, 1, 2, 2, 3, 1, 3, 1, 3, 2, 2, 1, 1, 2, 1, 3, 1, 3, 1, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1, 2, 3, 1, 1, 3, 2, 2, 1, 3, 1, 2, 1, 1, 1, 3, 1, 1, 2, 1, 1, 1, 2, 3, 2, 2, 1, 1, 1, 2, 1, 1, 3, 1, 1, 3, 1, 2, 1, 2, 2, 1, 1, 2, 1, 2, 2, 3, 2, 2, 2, 3, 3, 2, 1, 2, 1, 3, 2, 3]
02/23/2023 13:04:19:INFO: ---------Evaluated Metrics----------
02/23/2023 13:04:19:INFO: Accuracy: 0.6259168704156479.
02/23/2023 13:04:19:INFO: Macro Precision: 0.5895874602771155.
02/23/2023 13:04:19:INFO: Macro Recall: 0.5835712750606367.
02/23/2023 13:04:19:INFO: Macro F1 score: 0.5805808058777484.
02/23/2023 13:04:19:INFO: ---------confusion_matrix----------
02/23/2023 13:04:19:INFO: 
[[163  53  15]
 [ 30  49  15]
 [ 10  30  44]]
02/23/2023 13:04:19:INFO: 模型效果验证详情: {'位置第一个显示标签': 142, '其他位置有情感标签': 0, '全句没有情感标签': 0}.
02/23/2023 13:04:19:INFO: ----------------------Testing finished.------------------------
02/23/2023 13:04:19:INFO: bengio.
